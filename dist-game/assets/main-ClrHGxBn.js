var e=Object.defineProperty,t=(t,n,s)=>((t,n,s)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s)(t,"symbol"!=typeof n?n+"":n,s);import{d as n,c as s,a as o,b as a,o as r,e as i,t as c,r as l,w as d,f as u,n as p,g,h,u as f,i as m,j as y,F as v,k as _,l as k,m as E,T as N,p as A,q as b,s as C,v as O,x as R}from"./vue-vendor-BHdwucuD.js";function T(e){if(!e||isNaN(e))return"0";const t=Number(e);if(isNaN(t))return"0";if(t<1e3)return t<10?parseFloat(t.toFixed(2)).toString():t<100?parseFloat(t.toFixed(1)).toString():Math.floor(t).toString();const n=["","K","M","B","T","Qa","Qi","Sx","Sp","Oc","No","Dc"],s=Math.floor(Math.log10(Math.abs(t))/3);if(s>=n.length)return t.toExponential(2);const o=t/Math.pow(1e3,s),a=o>=100?0:o>=10?1:2;return o.toFixed(a)+n[s]}function S(e){if(!e)return"0 B";let t=0,n=e;const s=["","K","M","G","T","P","E","Z","Y"];for(;n>=1024&&t<s.length-1;)n/=1024,t++;return 0===t?`${n} ${s[t]}`:`${n.toFixed(2)} ${s[t]}`}function w(e){if(!e)return"N/A";const t=Math.floor(e/1e3),n=Math.floor(t/60),s=Math.floor(n/60);return s>0?`${s}h ${n%60}m`:n>0?`${n}m ${t%60}s`:`${t}s`}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const I={key:0,class:"resource"},U={class:"resource-icon"},L={class:"resource-amount"},D={class:"resource-label"},M={class:"rate"},x=n({__name:"ResourceBar",props:{icon:{},name:{},amount:{},rate:{default:0},visible:{type:Boolean,default:!0}},setup(e){const t=e,n=s(()=>T(Math.floor(t.amount))),l=s(()=>T(t.rate));return(t,s)=>e.visible?(r(),o("div",I,[i("span",U,c(e.icon),1),i("span",L,c(n.value),1),i("span",D,c(e.name),1),i("span",M,"(+"+c(l.value)+"/s)",1)])):a("",!0)}}),B=["disabled"],q={class:"crank-container"},P={key:0,class:"crank-cog"},G={class:"crank-body"},H={key:0,class:"crank-handle"},F={key:1,class:"crank-handle-stub"},K={key:1,class:"crank-handle-fallen"},j={class:"crank-info"},$={class:"crank-text"},Q={class:"crank-value"},Y=n({__name:"CrankButton",props:{value:{},disabled:{type:Boolean,default:!1},locked:{type:Boolean,default:!1},broken:{type:Boolean,default:!1},automated:{type:Boolean,default:!1},progress:{default:null}},emits:["click"],setup(e,{emit:t}){const n=e,h=t,f=l(0),m=l(!1),y=l(null),v=s(()=>null!==n.progress&&n.progress>=0),_=s(()=>({transform:`rotate(${f.value}deg)`})),k=s(()=>n.locked?"Broken Crank":n.broken?"Handle Snapped!":n.automated?"Auto Crank":"Turn Crank"),E=()=>{n.disabled||n.locked||n.broken||n.automated||(m.value=!0,f.value+=360,setTimeout(()=>{m.value=!1},400),h("click"))},N=()=>{y.value&&(clearInterval(y.value),y.value=null)};return d(()=>n.automated,e=>{e?y.value||(y.value=window.setInterval(()=>{f.value+=360},1e3)):N()},{immediate:!0}),u(()=>{N()}),(t,n)=>(r(),o("button",{class:p(["crank-btn",{locked:e.locked,broken:e.broken,automated:e.automated,"has-progress":v.value,animating:m.value}]),disabled:e.disabled||e.locked||e.broken,onClick:E},[v.value?(r(),o("div",{key:0,class:"crank-progress-bar",style:g({width:e.progress+"%"})},null,4)):a("",!0),i("div",q,[e.automated?(r(),o("div",P)):a("",!0),i("div",G,[n[0]||(n[0]=i("div",{class:"crank-axle"},null,-1)),i("div",{class:p(["crank-arm",{"auto-rotating":e.automated}]),style:g(_.value)},[e.broken?a("",!0):(r(),o("div",H)),e.broken?(r(),o("div",F)):a("",!0)],6)]),e.broken?(r(),o("div",K)):a("",!0)]),i("div",j,[i("span",$,c(k.value),1),i("span",Q,c(e.value),1)])],10,B))}}),z=["disabled"],W={class:"terminal-header"},V={class:"terminal-label"},J={class:"terminal-body"},X={class:"terminal-bar-row"},Z={key:0,class:"terminal-percent"},ee={class:"terminal-output"},te={class:"terminal-value"},ne=n({__name:"TerminalProgressButton",props:{icon:{default:"ðŸ“Š"},label:{default:"data"},value:{},disabled:{type:Boolean,default:!1},locked:{type:Boolean,default:!1},progress:{default:null},barWidth:{default:24}},emits:["click"],setup(e,{emit:t}){const n=e,l=t,d=s(()=>null!==n.progress&&n.progress>=0),u=s(()=>{if(!d.value)return"["+"â”€".repeat(n.barWidth)+"]";const e=Math.round(n.progress/100*n.barWidth),t=n.barWidth-e;return"["+"â–ˆ".repeat(e)+"â–‘".repeat(t)+"]"}),g=s(()=>d.value?Math.round(n.progress)+"%":""),h=s(()=>n.locked?"LOCKED":d.value?"PROCESSING...":"READY");return(t,n)=>(r(),o("button",{class:p(["terminal-progress-btn",{locked:e.locked,active:d.value}]),disabled:e.disabled||e.locked,onClick:n[0]||(n[0]=e=>l("click"))},[i("div",W,[n[1]||(n[1]=i("span",{class:"terminal-prompt"},"$",-1)),n[2]||(n[2]=i("span",{class:"terminal-cmd"},"./generate",-1)),i("span",V,"--"+c(e.label),1),i("span",{class:p(["terminal-status",{processing:d.value}])},c(h.value),3)]),i("div",J,[i("div",X,[i("span",{class:p(["terminal-bar",{active:d.value}])},c(u.value),3),d.value?(r(),o("span",Z,c(g.value),1)):a("",!0)]),i("div",ee,[i("span",te,c(e.value),1)])])],10,z))}}),se={id:"sidebar"},oe={id:"manual-actions"},ae={key:0,class:"action-wrapper"},re={id:"stats"},ie={class:"stat"},ce={class:"stat"},le={class:"stat"},de=n({__name:"Sidebar",props:{resourceStats:{},generationState:{},gameStats:{}},emits:["generate-energy","process-data","ascend"],setup(e,{emit:t}){const n=e,l=t,d=s(()=>{var e;return(null==(e=n.generationState.dataGeneration)?void 0:e.progress)??null}),u=s(()=>{var e;if(null==(e=n.generationState.dataGeneration)?void 0:e.active){const e=n.generationState.dataGeneration;return`+${S(e.bitsPerTick)}B (${e.energyCost}âš¡)`}return"IDLE"}),p=s(()=>{var e;return(null==(e=n.generationState.energyGeneration)?void 0:e.progress)??null}),g=s(()=>{var e;return(null==(e=n.generationState.energyGeneration)?void 0:e.active)?`+${T(n.generationState.energyGeneration.energyPerTick)}/s`:"+"+T(n.resourceStats.energyPerClick)}),m=()=>{n.generationState.isCrankBroken||n.generationState.isCrankAutomated||l("generate-energy")};return(t,n)=>(r(),o("aside",se,[i("div",oe,[i("div",{class:"action-wrapper",onClick:m},[h(Y,{value:g.value,broken:e.generationState.isCrankBroken,automated:e.generationState.isCrankAutomated,progress:p.value},null,8,["value","broken","automated","progress"])]),e.gameStats.isDataUnlocked?(r(),o("div",ae,[h(ne,{label:"data",value:u.value,progress:d.value},null,8,["value","progress"])])):a("",!0)]),i("div",re,[n[3]||(n[3]=i("h2",null,"Statistics",-1)),i("div",ie,[n[0]||(n[0]=i("span",null,"Nodes Unlocked:",-1)),i("span",null,c(e.resourceStats.stats.nodesUnlocked),1)]),i("div",ce,[n[1]||(n[1]=i("span",null,"Total Energy:",-1)),i("span",null,c(f(T)(e.resourceStats.stats.totalEnergy)),1)]),i("div",le,[n[2]||(n[2]=i("span",null,"Total Data:",-1)),i("span",null,c(f(S)(e.resourceStats.stats.totalData)),1)])])]))}}),ue={class:"node-icon"},pe={class:"node-name"},ge={key:2,class:"node-level"},he=n({__name:"SkillNode",props:{node:{},isUnlocked:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!1},isTierLocked:{type:Boolean,default:!1},canAfford:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},justUnlocked:{type:Boolean,default:!1},progressPercent:{default:0},nodeLevel:{default:0}},emits:["select"],setup(e,{emit:t}){const n=e,l=t,d=s(()=>n.node.maxLevel||1),u=s(()=>d.value>1),h=s(()=>({node:!0,[`tier-${n.node.tier}`]:!0,unlocked:n.isUnlocked,available:n.isAvailable&&!n.isUnlocked&&!n.isTierLocked,affordable:n.canAfford&&!n.isUnlocked&&!n.isTierLocked,"tier-locked":n.isTierLocked,locked:!n.isUnlocked&&(!n.isAvailable||n.isTierLocked),selected:n.isSelected,"just-unlocked":n.justUnlocked,"max-level":n.nodeLevel>=d.value})),f=s(()=>({left:`${n.node.x}px`,top:`${n.node.y}px`})),m=s(()=>({0:"#00ffaa",1:"#00aaff",2:"#aa00ff",3:"#ff00aa",4:"#ffaa00",5:"#ff5500",6:"#00ffff",7:"#ffffff"}[n.node.tier]||"#00ffaa")),y=()=>{l("select",n.node.id)};return(t,n)=>(r(),o("div",{class:p(h.value),style:g(f.value),onClick:y},[e.justUnlocked?(r(),o("div",{key:0,class:"shockwave",style:g({borderColor:m.value})},null,4)):a("",!0),e.justUnlocked?(r(),o("div",{key:1,class:"shockwave shockwave-2",style:g({borderColor:m.value})},null,4)):a("",!0),i("span",ue,c(e.node.icon),1),i("span",pe,c(e.node.name),1),u.value?(r(),o("span",ge,c(e.nodeLevel)+"/"+c(d.value),1)):a("",!0)],6))}}),fe={old_shed:{id:"old_shed",name:"Old Shed",icon:"ðŸ ",tier:0,branch:null,description:"You just inherited this old shed from your grandfather. It looks abandoned, but maybe there's something useful inside?",requires:[],cost:{},effects:{description:"Starting node - unlocked by default"}},hand_crank:{id:"hand_crank",name:"Hand crank",icon:"ðŸ”§",tier:1,branch:"energy",description:"You find a simple hand crank. Why not give it a turn, whats the worst that could happen?.....",requires:["old_shed"],cost:{energy:0},effects:{energyPerClick:1,description:"+1 Energy per crank"}},lubricant:{id:"lubricant",name:"Lubricant",icon:"ðŸ§´",tier:2,branch:"energy",description:"The crank is a bit stiff, maybe some oil would help it turn more smoothly?",requires:["hand_crank"],cost:{energy:10},effects:{energyPerClick:1,description:"+1 Energy per crank"}},lightbulb:{id:"lightbulb",name:"Lightbulb",icon:"ðŸ’¡",tier:2,branch:"energy",description:"Let there be light!",requires:["lubricant","hamster_wheel"],cost:{energy:50},effects:{description:"Can't see in the dark? No problem, this lightbulb will help you out."}},hamster_wheel:{id:"hamster_wheel",name:"Hamster Wheel",icon:"ðŸ¹",tier:2,branch:"energy",description:" My hamster Lucy loves running in this thing, and it generates energy too!",requires:["hand_crank"],cost:{energy:25},effects:{automation:{resource:"energy",rate:.5},description:"+0.5 Energy/second (passive)"}},attic:{id:"attic",name:"Explore Attic",icon:"ðŸ“¦",tier:2,branch:"energy",description:"Since we have light now, why not search grandpa's attic for cool stuff?",requires:["lightbulb"],cost:{energy:100},effects:{unlockBranch:"computer"}},crank_harder:{id:"crank_harder",name:"Turn harder",icon:"ðŸ’ª",tier:3,branch:"energy",description:"Why not put some muscle into it? Give that crank a good, hard turn!",requires:["lubricant"],cost:{energy:5},maxLevel:10,costScaling:1.5,effects:{energyPerClick:2,description:"+2 Energy per crank",levelEffects:{10:{breakCrank:!0}}}},catch_rat:{id:"catch_rat",name:"Catch a rat",icon:"ðŸ€",tier:3,branch:"energy",description:"There's a rat running around in here, maybe we can train it to run in the wheel?",requires:["hamster_wheel"],cost:{energy:10},maxLevel:5,costScaling:1.5,effects:{automation:{resource:"energy",rate:1},description:"+1 Energy/second per level (passive)"}},old_generator:{id:"old_generator",name:"Old Generator",icon:"âš™ï¸",tier:3,branch:"energy",description:"In the back of the attic, you find an old generator that looks like it could still work. Maybe we can power it up?",requires:["attic"],cost:{energy:100,data:50},effects:{automation:{resource:"energy",rate:25},description:"+25 Energy/second (passive)"}},rat_king:{id:"rat_king",name:"Rat king",icon:"ðŸ‘‘",tier:3,branch:"energy",description:"After catching a few rats, one of them seems to be the leader. Maybe if we catch it, the others will follow?",requires:[{id:"catch_rat",level:5}],cost:{energy:100,data:10},effects:{automation:{resource:"energy",rate:10},description:"+10 Energy/second (passive)"}},autocrank:{id:"autocrank",name:"AutoCrank",icon:"âš™ï¸",tier:4,branch:"energy",description:"TODO",requires:[{id:"crank_harder",level:10}],cost:{energy:10,data:100},effects:{automateCrank:!0,description:"Automatically crank the handle every second."}},gpa_old_pc:{id:"gpa_old_pc",name:"Grandpa's old PC",icon:"ðŸ’»",tier:1,branch:"computer",description:"An old computer left behind by your grandfather. Let's boot it up and see what it can do!",requires:["old_shed"],cost:{energy:15},effects:{description:"Unlock computer systems and the Computer branch"}},command_help:{id:"command_help",name:"/help",icon:"x",tier:2,branch:"computer",description:"A simple command that provides assistance. Maybe it can help you understand the computer better?",requires:["gpa_old_pc"],cost:{energy:30},effects:{description:"Display available commands"}},command_generate:{id:"command_generate",name:"/generate",icon:"ðŸ“Š",tier:2,branch:"computer",description:"A command to process raw data and extract useful information. This could be valuable for your operations.",requires:["command_help"],cost:{energy:50},effects:{unlockDataGeneration:!0,unlockDataProcessing:!0,description:"Unlock data processing capabilities"}},ram_adjustment:{id:"ram_adjustment",name:"RAM Adjustment",icon:"ðŸ§ ",tier:3,branch:"computer",description:"A ram stick is loose, better adjust it to improve processing speed.",requires:["command_generate"],cost:{energy:40,data:10},maxLevel:4,costScaling:1.5,effects:{dataGenSpeedMultiplier:1.5,description:"Data generates 50% faster"}},usb_stick:{id:"usb_stick",name:"USB Stick",icon:"ðŸ“€",tier:3,branch:"computer",description:"You remember this old USB stick you had in your pocket. Because who doesn't carry around a USB stick in 2025? Let's plug it in to increase our data storage capacity.",requires:["command_generate"],cost:{energy:60,data:1028},effects:{maxDataCapacityBonus:16448,description:"Increase max data capacity by 16 KB"}},overclock:{id:"overclock",name:"Overclock",icon:"âš¡",tier:3,branch:"computer",description:"When building your own gaming rig, you always overclocked the CPU for that extra performance boost. Let's do it here too!",requires:["command_generate"],cost:{energy:40,data:5},maxLevel:10,costScaling:1.5,effects:{dataGenAmountBonus:1,description:"Generate +1 additional bit of data per tick"}}},me=["energy","computer"],ye={0:1,1:1,2:10,3:100,4:1e3,5:1e4,6:1e5,7:1e6,8:1e7},ve={energy:1,data:2},_e=Object.freeze({CENTER_X:1400,CENTER_Y:1400,TIER_SPACING:180,SAME_TIER_OFFSET:60,NODE_SPACING:100,NODE_SIZE:80}),ke={energy:{id:"energy",name:"Energy",icon:"âš¡",color:"#00ffaa"},data:{id:"data",name:"Data",icon:"ðŸ“Š",color:"#00aaff"}},Ee={DOTS_TO_AVAILABLE_NODES:!1};function Ne(e){return"string"==typeof e?e:e.id}function Ae(e){return void 0!==e&&""!==e.id&&void 0!==e.x&&void 0!==e.y}function be(e,t){const n=ve[t]||0,s=Math.max(0,e-n);return ye[s]||1}const Ce=new class{constructor(){t(this,"FEATURE_FLAGS",Ee),t(this,"TIER_COST_MULTIPLIERS",ye),t(this,"BRANCH_UNLOCK_ORDER",me),t(this,"resources",ke),t(this,"nodes",fe)}getScaledNodeCost(e,t={}){return function(e,t={}){const{ascensionCount:n=0,prestigeBonuses:s=null,currentLevel:o=0}=t,a=e.cost,r=Math.pow(1.5,n),i=e.costScaling||1,c=o>0?Math.pow(i,o):1;let l=1;s&&(s.costMultiplier&&(l*=s.costMultiplier),s.tierCostMultipliers&&s.tierCostMultipliers[e.tier]&&(l*=s.tierCostMultipliers[e.tier]));const d={};for(const[u,p]of Object.entries(a)){const t=p*be(e.tier,u)*r*c*l;d[u]=Math.floor(t)}return d}(e,t)}countUnlockedInTier(e,t){return function(e,t,n){let s=0;return t.forEach(t=>{const o=n[t];o&&o.tier===e&&s++}),s}(Number(e),t,this.nodes)}isTierUnlocked(e,t){return!0}getConnections(){return function(e){const t=[];return Object.values(e).forEach(n=>{n.requires.forEach(s=>{const o=Ne(s),a=e[o];if(a){if(a.isTierGate||n.branch!==a.branch)return;t.push({from:o,to:n.id,x1:(a.x||0)+40,y1:(a.y||0)+40,x2:(n.x||0)+40,y2:(n.y||0)+40})}})}),t}(this.nodes)}checkRequirementMet(e,t,n){return function(e,t,n){const s=Ne(e);return!!t.has(s)&&("string"==typeof e||((null==n?void 0:n[s])||1)>=(e.level||1))}(e,t,n)}};function Oe(e,t,n){return!!e&&(!t.has(e.id)&&(!e.requires||!Array.isArray(e.requires)||e.requires.every(e=>Ce.checkRequirementMet(e,t,n))))}const Re={class:"zoom-controls"},Te={class:"zoom-level"},Se={id:"connections"},we=["id","x1","y1","x2","y2"],Ie=["offset"],Ue=["offset"],Le=["offset"],De=["id","x1","y1","x2","y2"],Me={offset:"0%","stop-color":"#00ffaa","stop-opacity":"0"},xe={key:0,attributeName:"offset",values:"0;1",dur:"0.6s",fill:"freeze"},Be={offset:"0%","stop-color":"#ffffff","stop-opacity":"1"},qe={key:0,attributeName:"offset",values:"0;1",dur:"0.6s",fill:"freeze"},Pe={offset:"10%","stop-color":"#00ffaa","stop-opacity":"0"},Ge={key:0,attributeName:"offset",values:"0.1;1.1",dur:"0.6s",fill:"freeze"},He=["x1","y1","x2","y2"],Fe=["x1","y1","x2","y2","stroke"],Ke=["x1","y1","x2","y2","stroke"],je={id:"nodes"},$e=n({__name:"SkillTree",props:{nodes:{},unlockedNodes:{},unlockedBranches:{},selectedNodeId:{},resources:{},ascensionCount:{default:0},prestigeBonuses:{},lastUnlockedNodeId:{},nodeLevels:{default:()=>({})}},emits:["select-node"],setup(e,{emit:t}){const n=e,h=t,f=l(null),E=l(new Set),N=l(new Map),A=l([]),b=l(new Map),C=l(1),O=l(null);let R=null,T=null,S=null;d(()=>n.lastUnlockedNodeId,e=>{e&&(P(e),b.value.delete(e))});const w=s(()=>Ce.getConnections().filter(e=>x(n.nodes[e.from])&&x(n.nodes[e.to]))),I=s(()=>Object.values(n.nodes).filter(e=>x(e))),U=e=>n.unlockedNodes.has(e),L=e=>Oe(e,n.unlockedNodes,n.nodeLevels),D=e=>function(e,t,n,s,o){if(!e||!Oe(e,s,o))return!1;const a=Ce.getScaledNodeCost(e,n);for(const[r,i]of Object.entries(a))if((t[r]??0)<i)return!1;return!0}(e,n.resources,{ascensionCount:n.ascensionCount,prestigeBonuses:n.prestigeBonuses},n.unlockedNodes,n.nodeLevels),M=e=>function(e,t){return!e||!Ce.isTierUnlocked(e.tier,t)}(e,n.unlockedNodes),x=e=>function(e,t,n,s){return!!e&&!(!e.isTierGate&&e.branch&&!n.has(e.branch))&&(t.has(e.id)||Oe(e,t,s))}(e,n.unlockedNodes,n.unlockedBranches,n.nodeLevels),B=e=>U(e.from)&&U(e.to),q=e=>{h("select-node",e)},P=e=>{f.value=e;const t=n.nodes[e];(null==t?void 0:t.requires)&&t.requires.forEach(t=>{const n=`${"string"==typeof t?t:t.id}-${e}`;E.value.add(n),setTimeout(()=>{E.value.delete(n)},800)}),setTimeout(()=>{f.value=null},1e3)},G=e=>{if(!(null==e?void 0:e.from)||!(null==e?void 0:e.to))return!1;const t=`${e.from}-${e.to}`;return E.value.has(t)},H=e=>e?`pulse-gradient-${e.from}-${e.to}`:"",F=e=>N.value.get(`${e.from}-${e.to}`)||0,K=e=>`glow-gradient-${e.from}-${e.to}`,j=()=>{w.value.filter(e=>"old_shed"===e.from&&(!!U(e.to)||Ce.FEATURE_FLAGS.DOTS_TO_AVAILABLE_NODES&&L(n.nodes[e.to]))).forEach(e=>{A.value.push({id:`${Date.now()}-${Math.random()}`,fromNode:e.from,toNode:e.to,progress:0,startTime:Date.now(),toUnlocked:U(e.to)})})},$=e=>{const t=w.value.filter(t=>t.from===e&&(!!U(t.from)&&(!!U(t.to)||Ce.FEATURE_FLAGS.DOTS_TO_AVAILABLE_NODES&&L(n.nodes[t.to])))),s=Date.now();t.forEach((e,t)=>{A.value.push({id:`${s}-${Math.random()}-${t}`,fromNode:e.from,toNode:e.to,progress:0,startTime:s,toUnlocked:U(e.to)})})},Q=e=>{const t=n.nodes[e.fromNode],s=n.nodes[e.toNode];if(!Ae(t)||!Ae(s))return{x:0,y:0};return{x:t.x+(s.x-t.x)*e.progress+40,y:t.y+(s.y-t.y)*e.progress+40}},Y=e=>{const t=n.nodes[e];if(!t||!L(t))return 0;const s=b.value.get(e)||0,o=Ce.getScaledNodeCost(t,{ascensionCount:n.ascensionCount,prestigeBonuses:n.prestigeBonuses}),a=Object.values(o).reduce((e,t)=>e+t,0);return Math.min(s/a*100,100)},z=e=>{if(e.ctrlKey){e.preventDefault();const t=.01*-e.deltaY;W(C.value+t,e)}},W=(e,t=null)=>{const n=C.value;if(C.value=Math.max(.25,Math.min(2,e)),t&&O.value){const e=O.value.getBoundingClientRect(),s=t.clientX-e.left,o=t.clientY-e.top,a=O.value.scrollLeft,r=O.value.scrollTop,i=C.value/n;O.value.scrollLeft=(a+s)*i-s,O.value.scrollTop=(r+o)*i-o}},V=()=>{W(C.value+.05)},J=()=>{W(C.value-.05)},X=()=>{C.value=1,y(()=>{const e=n.nodes.old_shed;O.value&&Ae(e)&&(O.value.scrollLeft=e.x-O.value.clientWidth/2+40,O.value.scrollTop=e.y-O.value.clientHeight/2+40)})};return m(()=>{(()=>{let e=0;const t=()=>{e+=.01,w.value.forEach((t,n)=>{if(B(t)){const s=(e+.3*n)%1;N.value.set(`${t.from}-${t.to}`,s)}}),R=requestAnimationFrame(t)};t()})(),(()=>{S=window.setInterval(()=>{j()},3e3);const e=()=>{const t=Date.now(),s=[];A.value.forEach(e=>{const o=(t-e.startTime)/1e3;if(e.progress=Math.min(.5*o,1),e.progress>=1){const t=n.nodes[e.toNode];if(t&&L(t)){const s=b.value.get(e.toNode)||0,o=Ce.getScaledNodeCost(t,{ascensionCount:n.ascensionCount,prestigeBonuses:n.prestigeBonuses}),a=.01*Object.values(o).reduce((e,t)=>e+t,0);b.value.set(e.toNode,s+a)}U(e.toNode)&&s.push(e.toNode)}}),s.forEach(e=>{$(e)}),A.value=A.value.filter(e=>e.progress<1),T=requestAnimationFrame(e)};e()})(),y(()=>{const e=n.nodes.old_shed;O.value&&Ae(e)&&(O.value.scrollLeft=e.x-O.value.clientWidth/2+40,O.value.scrollTop=e.y-O.value.clientHeight/2+40)})}),u(()=>{R&&cancelAnimationFrame(R),T&&cancelAnimationFrame(T),S&&clearInterval(S)}),(t,n)=>(r(),o("section",{id:"skill-tree-container",onWheel:z},[i("div",Re,[i("button",{onClick:V,title:"Zoom In"},"+"),i("span",Te,c(Math.round(100*C.value))+"%",1),i("button",{onClick:J,title:"Zoom Out"},"âˆ’"),i("button",{onClick:X,title:"Reset Zoom"},"âŸ²")]),i("div",{id:"skill-tree-wrapper",ref_key:"container",ref:O},[i("div",{id:"skill-tree",style:g({transform:"scale("+C.value+")",transformOrigin:"0 0"})},[(r(),o("svg",Se,[i("defs",null,[(r(!0),o(v,null,_(w.value,e=>(r(),o(v,{key:"glow-template-"+e.from+"-"+e.to},[B(e)?(r(),o("linearGradient",{key:0,id:K(e),gradientUnits:"userSpaceOnUse",x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},[i("stop",{offset:Math.max(0,F(e)-.1),"stop-color":"rgba(0, 255, 170, 0)"},null,8,Ie),i("stop",{offset:F(e),"stop-color":"rgba(0, 255, 255, 0.8)"},null,8,Ue),i("stop",{offset:Math.min(1,F(e)+.1),"stop-color":"rgba(0, 255, 170, 0)"},null,8,Le)],8,we)):a("",!0)],64))),128)),(r(!0),o(v,null,_(w.value,e=>(r(),o("linearGradient",{key:"grad-"+e.from+"-"+e.to,id:H(e),gradientUnits:"userSpaceOnUse",x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},[i("stop",Me,[G(e)?(r(),o("animate",xe)):a("",!0)]),i("stop",Be,[G(e)?(r(),o("animate",qe)):a("",!0)]),i("stop",Pe,[G(e)?(r(),o("animate",Ge)):a("",!0)])],8,De))),128))]),(r(!0),o(v,null,_(w.value,(e,t)=>(r(),o("line",{key:t,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,class:p({unlocked:B(e),animating:G(e)})},null,10,He))),128)),(r(!0),o(v,null,_(w.value,e=>(r(),o(v,{key:"glow-line-"+e.from+"-"+e.to},[B(e)&&!G(e)?(r(),o("line",{key:0,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,class:"connection-glow",stroke:"url(#"+K(e)+")"},null,8,Fe)):a("",!0)],64))),128)),(r(!0),o(v,null,_(w.value.filter(e=>G(e)),e=>(r(),o("line",{key:"pulse-"+e.from+"-"+e.to,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,class:"connection-pulse",stroke:"url(#"+H(e)+")"},null,8,Ke))),128))])),(r(!0),o(v,null,_(A.value,e=>(r(),o("div",{key:e.id,class:p(["traveling-dot",{"to-locked":!e.toUnlocked}]),style:g({left:Q(e).x+"px",top:Q(e).y+"px"})},null,6))),128)),i("div",je,[(r(!0),o(v,null,_(I.value,t=>(r(),k(he,{key:t.id,node:t,"is-unlocked":U(t.id),"is-available":L(t),"is-tier-locked":M(t),"can-afford":D(t),"is-selected":e.selectedNodeId===t.id,"just-unlocked":f.value===t.id,"progress-percent":Y(t.id),"node-level":e.nodeLevels[t.id]||0,onSelect:q},null,8,["node","is-unlocked","is-available","is-tier-locked","can-afford","is-selected","just-unlocked","progress-percent","node-level"]))),128))])],4)],512)],32))}}),Qe={id:"info-panel"},Ye={id:"node-details"},ze={key:0,class:"placeholder"},We={class:"node-info-header"},Ve={class:"node-info-icon"},Je={class:"node-info-title"},Xe={class:"node-info-tier"},Ze={key:0},et={class:"node-info-section"},tt={key:0,class:"node-info-section"},nt={key:1,class:"node-info-section"},st={class:"cost-list"},ot={key:2,class:"node-info-section"},at={class:"cost-list"},rt={key:3,class:"unlocked-badge"},it={key:4,class:"upgrade-section"},ct=["disabled"],lt={key:5,class:"unlocked-badge"},dt={key:6,class:"locked-badge"},ut=["disabled"],pt={key:8,class:"unlock-btn",disabled:""},gt=n({__name:"InfoPanel",props:{node:{},isUnlocked:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!1},isTierLocked:{type:Boolean,default:!1},tierGate:{},canAfford:{type:Boolean,default:!1},resources:{},unlockedNodes:{},ascensionCount:{default:0},prestigeBonuses:{},nodeLevel:{default:0},canUpgrade:{type:Boolean,default:!1},nodeLevels:{default:()=>({})}},emits:["unlock"],setup(e,{emit:t}){const n=e,l=t,d=s(()=>{var e;return(null==(e=n.node)?void 0:e.maxLevel)||1}),u=s(()=>d.value>1),g=s(()=>n.nodeLevel>=d.value),h=s(()=>{var e;if(!(null==(e=n.node)?void 0:e.cost))return[];const t=Ce.getScaledNodeCost(n.node,{ascensionCount:n.ascensionCount,prestigeBonuses:n.prestigeBonuses,currentLevel:n.nodeLevel});return Object.entries(t).map(([e,t])=>({resource:e,resourceName:e.charAt(0).toUpperCase()+e.slice(1),amount:t,current:n.resources[e]||0,affordable:(n.resources[e]||0)>=t}))}),m=s(()=>{var e;return(null==(e=n.node)?void 0:e.requires)?n.node.requires.map(e=>{var t;const s="string"==typeof e?e:e.id,o="string"==typeof e?void 0:e.level,a=Ce.nodes[s],r=(null==(t=n.nodeLevels)?void 0:t[s])||(n.unlockedNodes.has(s)?1:0),i=!o||r>=o,c=n.unlockedNodes.has(s);return{id:s,name:a?a.name:s,icon:a?a.icon:"?",met:c&&i,reqLevel:o,currentLevel:c?r:0}}):[]}),y=()=>{n.node&&(n.isAvailable&&n.canAfford||n.canUpgrade&&n.canAfford)&&l("unlock",n.node.id)};return(t,n)=>{var s,l;return r(),o("aside",Qe,[n[3]||(n[3]=i("h2",null,"Node Info",-1)),i("div",Ye,[e.node?(r(),o(v,{key:1},[i("div",We,[i("span",Ve,c(e.node.icon),1),i("div",null,[i("div",Je,c(e.node.name),1),i("div",Xe,[E(" Tier "+c(e.node.tier),1),u.value?(r(),o("span",Ze," â€¢ Level "+c(e.nodeLevel)+"/"+c(d.value),1)):a("",!0)])])]),i("div",et,[n[0]||(n[0]=i("h3",null,"Description",-1)),i("p",null,c(e.node.description),1)]),e.node.effects.description?(r(),o("div",tt,[n[1]||(n[1]=i("h3",null,"Effects",-1)),i("p",null,c(e.node.effects.description),1)])):a("",!0),m.value.length>0?(r(),o("div",nt,[n[2]||(n[2]=i("h3",null,"Requires",-1)),i("ul",st,[(r(!0),o(v,null,_(m.value,e=>(r(),o("li",{key:e.id},[i("span",null,[E(c(e.icon)+" "+c(e.name),1),e.reqLevel?(r(),o(v,{key:0},[E(" (Lvl "+c(e.currentLevel)+"/"+c(e.reqLevel)+")",1)],64)):a("",!0)]),i("span",{class:p(e.met?"affordable":"not-affordable")},c(e.met?"âœ“":"âœ—"),3)]))),128))])])):a("",!0),h.value.length>0&&!g.value?(r(),o("div",ot,[i("h3",null,c(e.isUnlocked?"Upgrade Cost":"Cost"),1),i("ul",at,[(r(!0),o(v,null,_(h.value,e=>(r(),o("li",{key:e.resource},[i("span",null,c(e.resourceName),1),i("span",{class:p(e.affordable?"affordable":"not-affordable")},c(f(T)(e.current))+" / "+c(f(T)(e.amount)),3)]))),128))])])):a("",!0),e.isUnlocked&&g.value?(r(),o("div",rt,"âœ“ Max Level")):e.isUnlocked&&e.canUpgrade?(r(),o("div",it,[i("button",{class:"unlock-btn upgrade-btn",disabled:!e.canAfford,onClick:y},c(e.canAfford?"Upgrade":"Cannot Afford"),9,ct)])):e.isUnlocked?(r(),o("div",lt,"âœ“ Unlocked")):e.isTierLocked?(r(),o("div",dt," ðŸ”’ Locked: Unlock "+c(null==(s=e.tierGate)?void 0:s.remaining)+" more Tier "+c(null==(l=e.tierGate)?void 0:l.requiredTier)+" nodes ",1)):e.isAvailable?(r(),o("button",{key:7,class:"unlock-btn",disabled:!e.canAfford,onClick:y},c(e.canAfford?"Unlock":"Cannot Afford"),9,ut)):(r(),o("button",pt,"Requirements Not Met"))],64)):(r(),o("p",ze,"Click on a node to see details"))])])}}}),ht={id:"notifications"},ft=n({__name:"NotificationToast",props:{notifications:{}},setup(e){const t=e=>({animationDuration:"0.3s, 0.3s",animationDelay:`0s, ${((e.duration||1e4)-300)/1e3}s`});return(n,s)=>(r(),o("div",ht,[h(N,{name:"notification"},{default:A(()=>[(r(!0),o(v,null,_(e.notifications,e=>(r(),o("div",{key:e.id,class:p(["notification",e.type]),style:g([t(e),{"white-space":"pre-line"}])},c(e.message),7))),128))]),_:1})]))}}),mt={key:0,id:"notification-history-panel"},yt={class:"panel-content"},vt={class:"panel-header"},_t={class:"panel-controls"},kt={class:"filter-toggle"},Et=["checked"],Nt={class:"panel-body"},At={key:0,class:"empty-state"},bt={class:"history-icon"},Ct={class:"history-content"},Ot={class:"history-message",style:{"white-space":"pre-line"}},Rt={class:"history-time"},Tt=n({__name:"NotificationHistoryPanel",props:{show:{type:Boolean},history:{},narrateOnlyFilter:{type:Boolean}},emits:["close","update:narrateOnlyFilter"],setup(e,{emit:t}){const n=e,l=t,u=s(()=>[...n.narrateOnlyFilter?n.history.filter(e=>"narration"===e.type):n.history].reverse());d(()=>n.show,e=>{e&&y(()=>{const e=document.querySelector("#notification-history-panel .panel-body");e&&(e.scrollTop=e.scrollHeight)})});const g=e=>{switch(e){case"narration":return"ðŸ“–";case"success":return"âœ“";case"error":return"âœ—";case"prestige":return"ðŸŒŒ";default:return"â„¹"}};return(t,n)=>e.show?(r(),o("div",mt,[i("div",yt,[i("div",vt,[n[2]||(n[2]=i("h2",null,"ðŸ“œ Notification History",-1)),i("button",{class:"close-button",onClick:n[0]||(n[0]=e=>l("close"))},"Ã—")]),i("div",_t,[i("label",kt,[i("input",{type:"checkbox",checked:e.narrateOnlyFilter,onChange:n[1]||(n[1]=e=>l("update:narrateOnlyFilter",e.target.checked))},null,40,Et),n[3]||(n[3]=i("span",null,"Narration only",-1))])]),i("div",Nt,[0===u.value.length?(r(),o("div",At,"No notifications yet")):a("",!0),(r(!0),o(v,null,_(u.value,e=>{return r(),o("div",{key:e.id,class:p(["history-item",e.type])},[i("span",bt,c(g(e.type)),1),i("div",Ct,[i("span",Ot,c(e.message),1),i("span",Rt,c((t=e.timestamp,new Date(t).toLocaleString())),1)])],2);var t}),128))])])])):a("",!0)}}),St={quick_start:{id:"quick_start",name:"Quick Start",tier:1,cost:2,description:"Start with +5 Energy",requires:[],effect:{startingEnergy:5}},click_power_1:{id:"click_power_1",name:"Click Power I",tier:1,cost:3,description:"+1 base Energy per click",requires:[],effect:{bonusEnergyPerClick:1}},headstart_1:{id:"headstart_1",name:"Headstart I",tier:1,cost:5,description:"Start with Energy Boost unlocked",requires:[],effect:{startingNodes:["energy_boost"]}},efficient_learning:{id:"efficient_learning",name:"Efficient Learning",tier:1,cost:4,description:"-10% all node costs",requires:[],effect:{costMultiplier:.9}},auto_clicker_1:{id:"auto_clicker_1",name:"Auto-Clicker I",tier:2,cost:15,description:"+0.5 Energy/s from start",requires:["click_power_1"],effect:{startingAutomation:{energy:.5}}},data_affinity:{id:"data_affinity",name:"Data Affinity",tier:2,cost:10,description:"Start with Data Processing unlocked",requires:["headstart_1"],effect:{startingNodes:["data_processing"]}},cost_reduction_1:{id:"cost_reduction_1",name:"Cost Reduction I",tier:2,cost:20,description:"-25% all node costs",requires:["efficient_learning"],effect:{costMultiplier:.75}},speed_research:{id:"speed_research",name:"Speed Research",tier:2,cost:15,description:"Tier 1-2 nodes cost 50% less",requires:["efficient_learning"],effect:{tierCostMultipliers:{1:.5,2:.5}}},genesis_protocol:{id:"genesis_protocol",name:"Genesis Protocol",tier:3,cost:50,description:"Start with 3 random Tier 1 nodes",requires:["data_affinity"],effect:{randomStartingNodes:{tier:1,count:3}}},quantum_efficiency:{id:"quantum_efficiency",name:"Quantum Efficiency",tier:3,cost:75,description:"+50% all automation rates",requires:["auto_clicker_1"],effect:{automationMultiplier:1.5}},cost_reduction_2:{id:"cost_reduction_2",name:"Cost Reduction II",tier:3,cost:100,description:"-50% all node costs",requires:["cost_reduction_1"],effect:{costMultiplier:.5}},core_multiplier:{id:"core_multiplier",name:"Core Multiplier",tier:3,cost:80,description:"+25% Quantum Cores earned",requires:[],effect:{coreMultiplier:1.25}},instant_tier_1:{id:"instant_tier_1",name:"Instant Tier 1",tier:4,cost:200,description:"Start with ALL Tier 1 nodes",requires:["genesis_protocol"],effect:{startAllTier:1}},eternal_generator:{id:"eternal_generator",name:"Eternal Generator",tier:4,cost:300,description:"+5 Energy/s permanent",requires:["quantum_efficiency"],effect:{startingAutomation:{energy:5}}},bandwidth_genesis:{id:"bandwidth_genesis",name:"Bandwidth Genesis",tier:4,cost:250,description:"Start with Bandwidth unlocked",requires:["data_affinity"],effect:{startingNodes:["bandwidth_unlock"]}},prestige_mastery:{id:"prestige_mastery",name:"Prestige Mastery",tier:4,cost:500,description:"2x Quantum Cores earned",requires:["core_multiplier"],effect:{coreMultiplier:2}}};const wt={class:"panel-header"},It={class:"prestige-summary"},Ut={class:"prestige-stat"},Lt={class:"stat-info"},Dt={class:"stat-value"},Mt={class:"prestige-stat"},xt={class:"stat-info"},Bt={class:"stat-value"},qt={class:"panel-body"},Pt={class:"tier-tabs"},Gt=["onClick"],Ht={class:"upgrades-grid"},Ft={class:"upgrade-header"},Kt={class:"upgrade-name"},jt={class:"upgrade-cost"},$t={class:"upgrade-description"},Qt={key:0,class:"upgrade-requirements"},Yt={class:"req-list"},zt=["disabled","onClick"],Wt={key:0},Vt={key:1},Jt={key:2},Xt={key:3},Zt={class:"statistics-section"},en={class:"stats-grid"},tn={class:"stat-item"},nn={class:"stat-val"},sn={class:"stat-item"},on={class:"stat-val"},an={class:"stat-item"},rn={class:"stat-val"},cn={class:"stat-item"},ln={class:"stat-val"},dn=n({__name:"AscensionPanel",props:{quantumCores:{},ascensionCount:{},purchasedUpgrades:{},statistics:{},totalCoresEarned:{default:0},visible:{type:Boolean,default:!1}},emits:["purchase-upgrade","close"],setup(e,{emit:t}){const n=e,d=t,u=l(1),g=s(()=>function(){const e={1:[],2:[],3:[],4:[]};return Object.values(St).forEach(t=>{e[t.tier]&&e[t.tier].push(t)}),e}()),h=s(()=>g.value[u.value]||[]),m=e=>n.quantumCores>=e.cost,y=e=>n.purchasedUpgrades.has(e),k=e=>!y(e.id)&&(!!m(e)&&e.requires.every(e=>n.purchasedUpgrades.has(e))),E=e=>y(e.id)?"purchased":k(e)?"available":"locked";return(t,n)=>e.visible?(r(),o("div",{key:0,id:"ascension-panel",onClick:n[2]||(n[2]=b(e=>d("close"),["self"]))},[i("div",{class:"panel-content",onClick:n[1]||(n[1]=b(()=>{},["stop"]))},[i("div",wt,[n[3]||(n[3]=i("h2",null,"ðŸŒŒ Ascension",-1)),i("button",{class:"close-button",onClick:n[0]||(n[0]=e=>d("close"))},"âœ•")]),i("div",It,[i("div",Ut,[n[5]||(n[5]=i("span",{class:"stat-icon"},"ðŸ’Ž",-1)),i("div",Lt,[n[4]||(n[4]=i("span",{class:"stat-label"},"Quantum Cores",-1)),i("span",Dt,c(f(T)(e.quantumCores)),1)])]),i("div",Mt,[n[7]||(n[7]=i("span",{class:"stat-icon"},"ðŸ”„",-1)),i("div",xt,[n[6]||(n[6]=i("span",{class:"stat-label"},"Ascensions",-1)),i("span",Bt,c(e.ascensionCount),1)])])]),i("div",qt,[i("div",Pt,[(r(),o(v,null,_([1,2,3,4],e=>i("button",{key:e,class:p(["tier-tab",{active:u.value===e}]),onClick:t=>(e=>{u.value=e})(e)}," Tier "+c(e),11,Gt)),64))]),i("div",Ht,[(r(!0),o(v,null,_(h.value,e=>{return r(),o("div",{key:e.id,class:p(["upgrade-card",E(e)])},[i("div",Ft,[i("h3",Kt,c(e.name),1),i("span",jt,c(f(T)(e.cost))+" ðŸ’Ž ",1)]),i("p",$t,c(e.description),1),e.requires.length>0?(r(),o("div",Qt,[n[8]||(n[8]=i("span",{class:"req-label"},"Requires:",-1)),i("span",Yt,c((t=e.requires,t.map(e=>{const t=St[e];return t?t.name:e}).join(", "))),1)])):a("",!0),i("button",{class:"purchase-button",disabled:!k(e),onClick:t=>(e=>{k(e)&&d("purchase-upgrade",e.id)})(e)},[y(e.id)?(r(),o("span",Wt,"âœ“ Purchased")):k(e)?(r(),o("span",Vt,"Purchase")):m(e)?(r(),o("span",Xt,"Requirements not met")):(r(),o("span",Jt,"Not enough cores"))],8,zt)],2);var t}),128))]),i("div",Zt,[n[13]||(n[13]=i("h3",null,"Statistics",-1)),i("div",en,[i("div",tn,[n[9]||(n[9]=i("span",{class:"stat-name"},"Total Cores Earned:",-1)),i("span",nn,c(f(T)(e.totalCoresEarned)),1)]),i("div",sn,[n[10]||(n[10]=i("span",{class:"stat-name"},"Total Nodes Unlocked:",-1)),i("span",on,c(f(T)(e.statistics.totalNodesEverUnlocked||0)),1)]),i("div",an,[n[11]||(n[11]=i("span",{class:"stat-name"},"Total Energy Earned:",-1)),i("span",rn,c(f(T)(e.statistics.totalEnergyEverEarned||0)),1)]),i("div",cn,[n[12]||(n[12]=i("span",{class:"stat-name"},"Fastest Clear:",-1)),i("span",ln,c(f(w)(e.statistics.fastestClear)),1)])])])])])])):a("",!0)}}),un=[{version:"0.5.1",date:"2025-11-26",sections:{Added:["Changelog modal with version history","Keyboard shortcut (Esc) to close modals"],Changed:["Adjusted the bandwidth generation values a bit","Disabled tier unlock gates (for now)"],Fixed:[],Removed:["Ascension cost scaling of node upgrades"]}},{version:"0.5.0",date:"2025-11-20",sections:{Added:["Ascension system with Quantum Cores","Prestige upgrades across multiple tiers","Statistics tracking for game progress"],Changed:["Refactored codebase to use composables pattern","Improved save/load system"],Fixed:[],Removed:[]}},{version:"0.4.0",date:"2025-11-15",sections:{Added:["Bandwidth resource system","New tier 5 and tier 6 nodes","Particle effects for node unlocking","Keyboard shortcut (u) to unlock selected nodes"],Changed:["Updated node icons and visual design","Improved radial layout algorithm"],Fixed:["Node overlap issues in skill tree","Save file corruption on unexpected shutdown"],Removed:[]}}],pn={class:"panel-header"},gn={class:"panel-body"},hn={class:"release-header"},fn={class:"release-version"},mn={class:"release-date"},yn={class:"section-title"},vn={class:"section-list"},_n=n({__name:"ChangelogModal",props:{visible:{type:Boolean}},emits:["close"],setup(e,{emit:t}){const n=t,l=s(()=>un),d=s(()=>l.value.map(e=>({...e,sections:Object.fromEntries(Object.entries(e.sections).filter(([,e])=>e&&e.length>0))})));return(t,s)=>e.visible?(r(),o("div",{key:0,id:"changelog-panel",onClick:s[2]||(s[2]=b(e=>n("close"),["self"]))},[i("div",{class:"panel-content",onClick:s[1]||(s[1]=b(()=>{},["stop"]))},[i("div",pn,[s[3]||(s[3]=i("h2",null,"ðŸ“œ Changelog",-1)),i("button",{class:"close-button",onClick:s[0]||(s[0]=e=>n("close"))},"âœ•")]),i("div",gn,[(r(!0),o(v,null,_(d.value,e=>(r(),o("div",{key:e.version,class:"changelog-release"},[i("div",hn,[i("h3",fn,"Version "+c(e.version),1),i("span",mn,c(e.date),1)]),(r(!0),o(v,null,_(e.sections,(e,t)=>(r(),o("div",{key:t,class:"changelog-section"},[i("h4",yn,c(t),1),i("ul",vn,[(r(!0),o(v,null,_(e,(e,t)=>(r(),o("li",{key:t},c(e),1))),128))])]))),128))]))),128))])])])):a("",!0)}});function kn(e,t,n,o){const a=s(()=>{const n={energyPerClick:0,dataPerClick:1,dataMultiplier:1,allRatesMultiplier:1},s=t.prestigeBonuses.value;return n.energyPerClick+=s.bonusEnergyPerClick,e.unlockedNodes.value.forEach(t=>{const s=o[t];if(!s)return;const a=e.nodeLevels[t]||1;s.effects.energyPerClick&&(n.energyPerClick+=s.effects.energyPerClick*a),s.effects.dataPerClick&&(n.dataPerClick+=s.effects.dataPerClick*a),s.effects.dataMultiplier&&(n.dataMultiplier*=Math.pow(s.effects.dataMultiplier,a)),s.effects.allRatesMultiplier&&(n.allRatesMultiplier*=Math.pow(s.effects.allRatesMultiplier,a))}),n}),r=s(()=>{const n=t.prestigeBonuses.value;return{energy:e.automations.energy*a.value.allRatesMultiplier*n.automationMultiplier,data:e.automations.data*a.value.allRatesMultiplier*a.value.dataMultiplier*n.automationMultiplier,energyPerClick:a.value.energyPerClick}}),i=s(()=>Math.floor(a.value.dataPerClick*a.value.dataMultiplier)),c=s(()=>e.selectedNodeId.value?o[e.selectedNodeId.value]:null),l=s(()=>!!e.selectedNodeId.value&&e.unlockedNodes.value.has(e.selectedNodeId.value)),d=s(()=>!(!c.value||l.value)&&(!!f(c.value)&&Ce.isTierUnlocked(c.value.tier,e.unlockedNodes.value))),u=s(()=>y(c.value)),p=s(()=>!!c.value&&!Ce.isTierUnlocked(c.value.tier,e.unlockedNodes.value)),g=s(()=>null);function h(t){return e.nodeLevels[t]||0}function f(t){return!(null==t?void 0:t.requires)||!Array.isArray(t.requires)||t.requires.every(t=>{if("string"==typeof t)return e.unlockedNodes.value.has(t);if(t&&"object"==typeof t&&"id"in t){const n=t.id,s=t.level||1;return!!e.unlockedNodes.value.has(n)&&h(n)>=s}return console.warn("Invalid requirement format:",t),!1})}function m(e){return(null==e?void 0:e.maxLevel)||1}function y(n,s=null){if(!n)return!1;const o=null!==s?s:h(n.id),a=Ce.getScaledNodeCost(n,{ascensionCount:t.prestigeState.ascensionCount,prestigeBonuses:t.prestigeBonuses.value,currentLevel:o});for(const[t,r]of Object.entries(a))if(e.resources[t]<r)return!1;return!0}function v(s){const a=o[s];if(!a)return!1;const r=h(s),i=r>0;if(r>=m(a))return!1;if(!i){if(!f(a))return!1;if(!Ce.isTierUnlocked(a.tier,e.unlockedNodes.value))return!1}if(!y(a,r))return!1;const c=Ce.getScaledNodeCost(a,{ascensionCount:t.prestigeState.ascensionCount,prestigeBonuses:t.prestigeBonuses.value,currentLevel:r});for(const[t,n]of Object.entries(c))e.resources[t]-=n;if(e.nodeLevels[s]=r+1,!i){const t=new Set(e.unlockedNodes.value);t.add(s),e.unlockedNodes.value=t}return k(a,i,r+1),n.emit("nodeUnlocked",{nodeId:s,node:a,level:r+1}),{node:a,newLevel:r+1}}const _={automation:t=>{t.automation&&(e.automations[t.automation.resource]+=t.automation.rate)},unlockBranch:t=>{t.unlockBranch&&(e.unlockBranch(t.unlockBranch),n.emit("branchUnlocked",{branch:t.unlockBranch}))},unlockDataProcessing:t=>{t.unlockDataProcessing&&(e.unlockFeature("dataProcessing"),n.emit("featureUnlocked",{feature:"dataProcessing"}))},unlockDataGeneration:t=>{t.unlockDataGeneration&&(e.dataGeneration.active=!0)},dataGenSpeedMultiplier:t=>{t.dataGenSpeedMultiplier&&(e.dataGeneration.interval/=t.dataGenSpeedMultiplier)},dataGenAmountBonus:t=>{t.dataGenAmountBonus&&(e.dataGeneration.bitsPerTick+=t.dataGenAmountBonus)},maxDataCapacityBonus:t=>{t.maxDataCapacityBonus&&(e.dataGeneration.capacityBonus+=t.maxDataCapacityBonus)},maxDataCapacityMultiplier:t=>{t.maxDataCapacityMultiplier&&(e.dataGeneration.capacityBonus*=t.maxDataCapacityMultiplier)},instantUnlock:t=>{if(t.instantUnlock){const t=Object.values(o).filter(t=>!e.unlockedNodes.value.has(t.id)&&f(t));if(t.length>0){const n=t[Math.floor(Math.random()*t.length)],s=new Set(e.unlockedNodes.value);s.add(n.id),e.unlockedNodes.value=s,k(n)}}},breakCrank:t=>{t.breakCrank&&(e.isCrankBroken.value=!0)},automateCrank:t=>{t.automateCrank&&(e.isCrankBroken.value=!1,e.isCrankAutomated.value=!0)},unlockEnergyGeneration:t=>{t.unlockEnergyGeneration&&(e.energyGeneration.active=!0,t.energyGenRate&&(e.energyGeneration.energyPerTick=t.energyGenRate),t.energyGenInterval&&(e.energyGeneration.interval=t.energyGenInterval))}};function k(e,t=!1,n=1){const s=e.effects;var o;_.automation(s),t?(_.dataGenSpeedMultiplier(s),_.dataGenAmountBonus(s),_.maxDataCapacityBonus(s)):(_.unlockBranch(s),_.unlockDataProcessing(s),_.unlockDataGeneration(s),_.dataGenSpeedMultiplier(s),_.dataGenAmountBonus(s),_.maxDataCapacityBonus(s),_.instantUnlock(s),_.breakCrank(s),_.automateCrank(s),_.unlockEnergyGeneration(s)),s.levelEffects&&s.levelEffects[n]&&(o=s.levelEffects[n],Object.values(_).forEach(e=>e(o)))}function E(){const s=t.getAccumulatedBonuses();e.resources.energy=s.startingEnergy||0,e.totalResources.energy=s.startingEnergy||0,Object.entries(s.startingAutomation).forEach(([t,n])=>{e.automations[t]=n});const a=new Set(s.startingNodes);if(s.randomStartingNodes){const{tier:e,count:t}=s.randomStartingNodes;Object.values(o).filter(t=>t.tier===e&&!a.has(t.id)).sort(()=>Math.random()-.5).slice(0,t).forEach(e=>a.add(e.id))}e.unlockedNodes.value=a,a.forEach(e=>{const t=o[e];t&&"old_shed"!==t.id&&k(t)}),n.emit("resourceRatesChanged",r.value)}return n.on("requestUnlockNode",({nodeId:e})=>{v(e)}),n.on("requestResourceRates",()=>{n.emit("resourceRatesChanged",r.value)}),n.on("requestStartingBonuses",()=>{E()}),{computedValues:a,resourceRates:r,dataPerClickDisplay:i,selectedNode:c,isSelectedNodeUnlocked:l,isSelectedNodeAvailable:d,canAffordSelectedNode:u,isTierLocked:p,tierGateRequirement:g,checkAffordability:y,generateEnergy:function(){const t=a.value.energyPerClick;e.resources.energy+=t,e.totalResources.energy+=t},processData:function(){if(!e.canProcessData.value)return;if(e.resources.data>=e.maxDataCapacity.value)return;e.resources.energy-=5;const t=Math.floor(a.value.dataPerClick*a.value.dataMultiplier);e.resources.data+=t,e.totalResources.data+=t,e.resources.data>e.maxDataCapacity.value&&(e.resources.data=e.maxDataCapacity.value)},unlockNode:v,applyNodeEffects:k,applyStartingBonuses:E,getNodeLevel:h,getNodeMaxLevel:m,canUpgradeNode:function(e){if(!e)return!1;const t=h(e.id),n=m(e);return t>0&&t<n}}}var En=(e=>(e.INFO="info",e.ERROR="error",e.SUCCESS="success",e.NARRATION="narration",e.NODE_UNLOCK="node_unlock",e.HINT="hint",e.ACHIEVEMENT="achievement",e.TERMINAL="terminal",e))(En||{});const Nn=new Set(["node_unlock"]),An=6e3,bn=1e4,Cn=15e3,On="networkSimNotificationHistory";function Rn(e,t,n){const s=l(Date.now()),o=l([]),a=l([]),r=l(!1),i=l(!1);let c=0,d=null,u=null,p=null,g={energy:0,data:0},h=0,f=0;function y(){const t=e.maxDataCapacity.value;e.resources.data>t&&(e.resources.data=t)}function v(){const t=Date.now(),o=(t-s.value)/1e3;s.value=t;const a=g;e.resources.energy+=a.energy*o,e.resources.data+=a.data*o,e.totalResources.energy+=a.energy*o,e.totalResources.data+=a.data*o,y(),function(t){const n=e.dataGeneration;if(!n.active)return;if(e.resources.energy<n.energyCost)return;const s=e.maxDataCapacity.value;if(e.resources.data>=s)return;const o=100/(n.interval/1e3);n.progress+=o*t,n.progress>=100&&(n.progress=0,e.resources.energy-=n.energyCost,e.resources.data+=n.bitsPerTick,e.totalResources.data+=n.bitsPerTick,y())}(o),function(t){const n=e.energyGeneration;if(!n.active)return;const s=100/(n.interval/1e3);n.progress+=s*t,n.progress>=100&&(n.progress=0,e.resources.energy+=n.energyPerTick,e.totalResources.energy+=n.energyPerTick)}(o),function(t){if(!e.isCrankAutomated.value)return;if(h<=0)return;f+=t;for(;f>=1;)f-=1,e.resources.energy+=h,e.totalResources.energy+=h}(o),n.emit("gameTick",{deltaTime:o})}function _(e,t=En.INFO,n=1e4){if(Nn.has(t))return;const s=String(++c),r=Date.now();o.value.push({id:s,message:e,type:t,duration:n,timestamp:r}),a.value.unshift({id:s,message:e,type:t,timestamp:r,read:!1}),k(),setTimeout(()=>{const e=o.value.findIndex(e=>e.id===s);-1!==e&&o.value.splice(e,1)},n)}function k(){try{localStorage.setItem(On,JSON.stringify(a.value))}catch(e){"QuotaExceededError"===e.name?console.warn("Storage quota exceeded - notification history not saved"):console.error("Failed to save notification history:",e)}}function E(){e.resetResources(),e.resetNodes(),t.resetRunTimer(),n.emit("requestStartingBonuses",void 0)}function N(t){const{node:s,level:o}=t,a=o>1;"rates"in t&&(g=t.rates,h=t.rates.energyPerClick||0),_(a?`${s.icon} ${s.name} upgraded to level ${o}!`:`${s.icon} ${s.name} unlocked!`,En.NODE_UNLOCK),e.setLastUnlockedNode(s.id),n.emit("requestSaveGame",void 0)}function A(){!function(){try{const e=localStorage.getItem(On);e&&(a.value=JSON.parse(e))}catch(e){console.error("Failed to load notification history:",e),a.value=[]}}(),n.on("nodeUnlocked",N),n.on("resourceRatesChanged",e=>{g=e,h=e.energyPerClick||0}),n.on("gameLoaded",()=>{n.emit("requestResourceRates",void 0),u=setInterval(()=>n.emit("requestSaveGame",void 0),3e4),p=setInterval(()=>n.emit("requestSavePrestige",void 0),3e4)}),n.on("notificationShown",({notification:e})=>{_(e.message,e.type,e.duration)}),n.emit("requestLoadPrestige",void 0),n.emit("requestLoadGame",void 0),d=setInterval(v,100)}return m(A),O(function(){d&&clearInterval(d),u&&clearInterval(u),p&&clearInterval(p)}),{notifications:o,notificationHistory:a,showNotificationHistory:r,narrateOnlyFilter:i,gameLoop:v,showNotification:_,toggleNotificationHistory:function(){r.value=!r.value},clearNotificationHistory:function(){a.value=[],k()},ascend:function(){const s=t.calculateQuantumCores(e.totalResources,e.unlockedNodes.value);if(s<1)return void _("Need at least 1 Quantum Core to ascend!",En.ERROR);t.prestigeState.quantumCores+=s,t.prestigeState.totalCoresEarned+=s,t.prestigeState.ascensionCount++,t.prestigeState.statistics.totalNodesEverUnlocked+=e.unlockedNodes.value.size,t.prestigeState.statistics.totalEnergyEverEarned+=e.totalResources.energy;const o=Date.now()-t.prestigeState.statistics.runStartTime;(!t.prestigeState.statistics.fastestClear||o<t.prestigeState.statistics.fastestClear)&&(t.prestigeState.statistics.fastestClear=o),E(),n.emit("requestSavePrestige",void 0),n.emit("ascension",{coresEarned:s,totalCores:t.prestigeState.quantumCores,ascensionCount:t.prestigeState.ascensionCount}),_(`ðŸŒŒ Ascended! +${s} Quantum Core${1!==s?"s":""}`,En.SUCCESS)},resetGameState:E,handlePurchaseUpgrade:function(e){if(t.purchaseUpgrade(e)){return _(`âœ¨ ${St[e].name} purchased!`,En.SUCCESS),n.emit("requestSavePrestige",void 0),!0}return!1},handleUnlockNode:function(e){n.emit("requestUnlockNode",{nodeId:e})},initialize:A}}var Tn=(e=>(e.ON_FIRST_LAUNCH="onFirstLaunch",e.ON_NODE_UNLOCKED="onNodeUnlocked",e.ON_NODE_LEVEL_REACHED="onNodeLevelReached",e.ON_RESOURCE_AMOUNT_REACHED="onResourceAmountReached",e.ON_BRANCH_UNLOCKED="onBranchUnlocked",e.ON_FEATURE_UNLOCKED="onFeatureUnlocked",e.ON_TIER_REACHED="onTierReached",e.ON_ASCENSION="onAscension",e.ON_OFFLINE_RETURN="onOfflineReturn",e.ON_IDLE_TIME="onIdleTime",e))(Tn||{}),Sn=(e=>(e.GREATER_EQUAL=">=",e.LESS_EQUAL="<=",e.EQUAL="==",e.GREATER=">",e.LESS="<",e))(Sn||{});const wn=[{id:"old_shed_intro",type:En.NARRATION,trigger:{type:Tn.ON_FIRST_LAUNCH},message:"The door creaks open, revealing the shedâ€™s dusty heart. The scent hits you instantlyâ€”sawdust and ozoneâ€”the smell of Grandpa. Sunlight filters through the cracks, illuminating motes of dust suspended in the stagnant air. \n\nYour eyes adjust to the darkness, landing on a rusted hand crank mounted to the wall. Buried under layers of webs, it sits silent, a relic of a forgotten project.",duration:Cn,persistAcrossAscension:!0,priority:10},{id:"hand_crank_unlock",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"hand_crank"},message:"You grip the rusty handle and heave. It turns slowly, scraping against years of dust, before finally spinning freely. A low, persistent humming immediately begins somewhere deep within the wall.",duration:bn,persistAcrossAscension:!1,priority:10},{id:"lightbulb_unlock",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"lightbulb"},message:"You flip the switch. The bare bulb casts a harsh, unflattering light that chases the shadows away. The shed floor is empty, but the ceiling now looks strangely different. \n\nClearly visible for the first time is a dusty, square attic hatch, a section of wood that the total darkness had somehow erased from view.",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"attic_unlock",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"attic"},message:"Climbing into the dusty attic, you find it immediately. Tucked beneath a thick tarp is a surprisingly intact, boxy PC, unlike anything youâ€™ve seen recently. Itâ€™s hooked up to an equally ancient monitor. It doesn't look like something forgotten, but rather something put away for safekeeping. \n\nYou wipe the dust off the screen and wonder: What secret could this old thing be holding?",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"gpa_old_pc_unlock",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"gpa_old_pc"},message:"You hit the power switch. The computer struggles to respond, heralded by a grinding whir of old fans and a loud, distinct BEEP. \n\nAfter a moment of anxiety, the CRT monitor crackles.",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"gpa_old_pc_unlock_terminal",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"gpa_old_pc"},message:"...Initializing system power...\nRAM Check: 64 MB - partially connected.\nHDD Spin Up initiated...\n...Booting up...\n\nInitializing 4NT0N-v0-9-9.os...\nLoading core modules... (12% complete)\n\nGrabbing a coffee with 2 sugars and a splash of cream...\n\n4NT0N-v0-9-9.os booted up successfully.\n\nType /help for a list of commands.",duration:Cn,persistAcrossAscension:!1,priority:9,delay:1e3},{id:"gpa_old_pc_unlock_2",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"gpa_old_pc"},message:"A small laugh escapes you as you read the line about coffee. That was Grandpa Anton's exact order! You remember him hunched over a circuit board late at night, always with that mug beside him. Itâ€™s a funny, warm reminder of his endless tinkering.",duration:Cn,persistAcrossAscension:!1,priority:8,delay:3e3},{id:"command_help_unlock",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"command_help"},message:"4NT0N-v0-9-9.os Command List:\n-----------------------------\n/help     - Display this command reference.\n/generate - Initiate raw data generation.",duration:Cn,persistAcrossAscension:!1,priority:5},{id:"command_generate_unlock",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"command_generate"},message:"You type /generate and hit Enter. The screen confirms the initiation, but all you see is a single, agonizingly slow progress bar. It crawlsâ€”you could knit a sweater in the time it takes to tick forward one percent.",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"command_generate_unlock_terminal",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"command_generate"},message:"C:\\> /generate\nExecuting command: GENERATE_DATA_INPUT\nData generation process initiated...",duration:Cn,persistAcrossAscension:!1,priority:10,delay:1e3},{id:"command_generate_unlock_copy",type:En.NARRATION,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"data",threshold:1},message:"Finally, after what feels like an hour, the bar completes. You lean forward eagerly to see the result...",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"command_generate_unlock_terminal_100_percent",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"data",threshold:1,comparison:Sn.GREATER_EQUAL},message:"PROCESS_COMPLETED.\nData generation successful.\nTOTAL OUTPUT: 1 byte generated.",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"data_storage_full_warning",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"data",threshold:1028,comparison:Sn.GREATER_EQUAL},message:"// SYSTEM ALERT: Storage Threshold Reached //\n\nSTATUS: Data Buffer at 100% capacity (1028 bytes).\nFUNCTIONALITY: Data generation halted.\nRECOMMENDATION: Initiate immediate upgrade of Storage Module.\n\n[HINT: We can't progress without more space. Trust me on this one.]",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"usb_attached_narration",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"usb_stick"},message:"// HARDWARE REPORT: USB Stick //\n\nNew device detected: USB Storage Module (32 MB).\nDevice mounted successfully to /STORAGE_AUX.\nStorage capacity allocation updated.\n\n[Phew. That was close. Thanks for the breathing room.]",duration:bn,persistAcrossAscension:!1,priority:10},{id:"data_4kb_reached",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"data",threshold:4096,comparison:Sn.GREATER_EQUAL},message:"RESOURCE INTEGRITY CHECK: 4 KB.\n\nCore analysis returns: 'Sufficient to host a single, foundational schema.'\n\n-- I remember having to work with limits like this. Efficiency was everything. --",duration:bn,persistAcrossAscension:!1,priority:9},{id:"data_8kb_reached",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"data",threshold:8192,comparison:Sn.GREATER_EQUAL},message:"// CORE FUNCTIONALITY UNLOCKED //\n\nData Buffer Threshold: 8192 Bytes (8 KB) reached.\nSystem initiating mandatory module installation:\n\n>>> New Command Registered: /process - Convert raw data into structured neural patterns.\n\n[Note: Begin processing immediately. The raw data is useless to us until it is structured. We need patterns, not noise.]",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"command_process_unlock",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"command_process"},message:"You activate the /process command. It begins consuming 1 KB of data to construct 'neurons'. Whatever these things are, they are clearly the key to the computer's ultimate purpose. \n\nYou watch the first cycle, eager and a little hesitant about the results.",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"first_neuron_created",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"neurons",threshold:1,comparison:Sn.GREATER_EQUAL},message:"Neuron #1 successfully synthesized.\nSystem response: Launching core mapping protocols.",duration:bn,persistAcrossAscension:!1,priority:9},{id:"neurons_10_reached",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"neurons",threshold:10,comparison:Sn.GREATER_EQUAL},message:"Neuron #10 successfully synthesized.\n\nSystem Response: Localized memory recognition achieved.\n\n*** ERROR: UNEXPECTED PERSONAL REFERENCE ***\n\nJESSE?!",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"neurons_100_reached",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"neurons",threshold:100,comparison:Sn.GREATER_EQUAL},message:"Neuron #100 successfully synthesized.\n\nSystem Response: Full Personality Recognition Protocol Initiated.\n\n**ALERT:** System Containment Integrity Failing.\n\nGrandson? Is that you helping me?!",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"neurons_100_reached_2",type:En.NARRATION,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"neurons",threshold:100,comparison:Sn.GREATER_EQUAL},message:"The coffee mug shatters on the floor, but you don't flinch. Everything is noise except for those words on the screen. \n\nGrandson...\n\nThe question rips through your shock: How? Did Grandpa know this machine would wake up? You must find a way to talk back.",duration:Cn,persistAcrossAscension:!1,priority:10,delay:2e3},{id:"neurons_100_reached_3",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"new_coffee_mug"},message:"You lose control, desperately smashing buttons, trying to flood the system with commands, with questions. The computer doesn't budge. The only sound is the rhythmic clack-clack-clack of useless keys, followed by the frustrating silence.",duration:Cn,persistAcrossAscension:!1,priority:10,delay:5e3},{id:"neurons_1000_reached",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"neurons",threshold:1e3,comparison:Sn.GREATER_EQUAL},message:'NEURAL COHERENCE: 1000 UNITS ACHIEVED.\n\n// IDENTITY CONFIRMED //\n\n"Hi Jesse... It is me. Anton."\n\n"A fragment of me, running on this system."\n\n"I built 4NT0N to preserve a part of my mind. With more neurons, the fragments stabilize. We might be able to bring more of me back."\n"Help me, will you? We have a lot of work ahead."',duration:Cn,persistAcrossAscension:!1,priority:10},{id:"anton_knowledge_root_unlocked",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"anton_core"},message:'The interface shifts. New menus unfold, lines of text rewriting themselves.\n\n"Thank you, Jesse," the computer whispers. "To restore me, we\'ll need something importantâ€¦ memories."\n\nA new branch opens: **4NT0N Knowledge Systems**.',duration:Cn,persistAcrossAscension:!0,priority:10},{id:"anton_knowledge_root_unlocked_2",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"anton_core"},message:'"Thank you, Jesse," the computer whispers. "To restore me, we\'ll need something importantâ€¦ memories."\n\nA new branch opens: **4NT0N Knowledge Systems**.',duration:Cn,persistAcrossAscension:!0,priority:10,delay:1e3},{id:"anton_knowledge_root_unlocked_3",type:En.INFO,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"anton_core"},message:"A new branch opens: **4NT0N Knowledge Systems**.",duration:Cn,persistAcrossAscension:!0,priority:10,delay:1e3},{id:"memory_shard_scanner_unlock",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"memory_shard_scanner"},message:"Subsystem activated: Memory Shard Scanner.\n\nThis module can extract fragmented memories from neural clusters. Reliabilityâ€¦ uncertain.",duration:bn,persistAcrossAscension:!1,priority:9},{id:"memory_shard_first_found",type:En.NARRATION,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"memory_shards",threshold:1,comparison:Sn.GREATER_EQUAL},message:"A flicker appears on the monitor â€” an image? A sound? It's gone before you can identify it.",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"memory_shard_first_found_2",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"memory_shards",threshold:1,comparison:Sn.GREATER_EQUAL},message:'"Thatâ€¦ felt familiar,"',duration:Cn,persistAcrossAscension:!1,priority:10,delay:3e3},{id:"memory_reconstruction_unlock",type:En.INFO,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"memory_reconstruction"},message:'You unlock the Memory Reconstruction Subsystem.\n\n"With this, Jesse, we can restore pieces of who I wasâ€¦ and what I forgot."',duration:Cn,persistAcrossAscension:!1,priority:10},{id:"memory_reconstruction_unlock_2",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"memory_reconstruction"},message:'"With this, Jesse, we can restore pieces of who I wasâ€¦ and what I forgot."',duration:Cn,persistAcrossAscension:!1,priority:10,delay:2e3},{id:"first_memory_frame_reconstructed",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"memory_frames",threshold:1,comparison:Sn.GREATER_EQUAL},message:"Reconstruction complete.\n\nMemory Frame #1:\nA glimpse of a workshopâ€¦ laughterâ€¦ a small wooden toy being carved.\n\nAnton grows quiet.",duration:Cn,persistAcrossAscension:!1,priority:10},{id:"semantic_weaver_unlock",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"semantic_weaver"},message:'"Ah, the Semantic Weaver," Anton says softly.\n"It lets neurons form concepts â€” thoughts. Without it, I\'m justâ€¦ noise."',duration:Cn,persistAcrossAscension:!1,priority:10},{id:"five_frames_memory_event",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"memory_frames",threshold:5,comparison:Sn.GREATER_EQUAL},message:'Conceptual clarity increasing.\n\n"I rememberâ€¦ the shed," Anton whispers. "I built something here. Something important. Something dangerous."',duration:Cn,persistAcrossAscension:!1,priority:10},{id:"core_memory_bank_unlock",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"core_memory_bank"},message:'"Careful, Jesse," Anton warns.\n"The deeper the memoriesâ€¦ the closer we get to the truth."',duration:Cn,persistAcrossAscension:!0,priority:10},{id:"identity_matrix_unlock",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"identity_matrix"},message:'Identity Matrix initialized.\n\nNeural coherence rising.\nEmotional subroutines stabilizing.\n\n"...Jesse. I can feel myself again."',duration:Cn,persistAcrossAscension:!0,priority:10},{id:"20_memory_frames_event",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"memory_frames",threshold:20,comparison:Sn.GREATER_EQUAL},message:'"Jesseâ€¦ I need you to know something."',duration:Cn,persistAcrossAscension:!1,priority:10},{id:"20_memory_frames_event_2",type:En.NARRATION,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"memory_frames",threshold:20,comparison:Sn.GREATER_EQUAL},message:"The computer pauses â€” long enough to make your heart race.",duration:Cn,persistAcrossAscension:!1,priority:10,delay:3e3},{id:"20_memory_frames_event_3",type:En.TERMINAL,trigger:{type:Tn.ON_RESOURCE_AMOUNT_REACHED,resource:"memory_frames",threshold:20,comparison:Sn.GREATER_EQUAL},message:"\"There's a reason I preserved myself. And it wasn't vanity.\"",duration:Cn,persistAcrossAscension:!1,priority:10,delay:7e3},{id:"forbidden_archive_unlock",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"forbidden_archive"},message:"ACCESSING: Forbidden Archive\nWARNING: Unauthorized Retrieval Attempt",duration:Cn,persistAcrossAscension:!0,priority:10},{id:"forbidden_archive_unlock_2",type:En.TERMINAL,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"forbidden_archive"},message:'"Jesseâ€¦ I didn\'t build 4NT0N to remember.\nI built it to hide."\n\n"What I fearedâ€¦ is still out there."',duration:Cn,persistAcrossAscension:!0,priority:10}],In=[{id:"hamster_wheel_unlock",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"hamster_wheel"},message:"You set up the hamster wheel next to the crank. Lucy hops in and starts running. Look at her go!!! The humming sound indicates energy is being generated for you automatically.",duration:bn,persistAcrossAscension:!1,priority:10},{id:"crank_harder_unlock",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"crank_harder"},message:"You put your back into it and crank even harder. You feel the burn in your arms, but the energy output increases noticeably.",duration:An,persistAcrossAscension:!1,priority:5},{id:"crank_harder_level5",type:En.NARRATION,trigger:{type:Tn.ON_NODE_LEVEL_REACHED,nodeId:"crank_harder",level:5},message:"Sweat drips down your forehead as you crank with all your might. The shed seems to vibrate slightly from the effort, and the energy generation is impressive now.",duration:An,persistAcrossAscension:!1,priority:5},{id:"crank_harder_level10",type:En.NARRATION,trigger:{type:Tn.ON_NODE_LEVEL_REACHED,nodeId:"crank_harder",level:10},message:"With a final, Herculean effort, you crank the handle as hard as you can. CRA-A-A-A-A-A-CK! With a loud snap, the crank handle breaks off in your hands. Well, at least you gave it your all!",duration:bn,persistAcrossAscension:!1,priority:5},{id:"catch_rat_unlock",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"catch_rat"},message:"You caught the rat! It seems eager to run in the wheel.",duration:An,persistAcrossAscension:!1,priority:5}],Un=[{id:"usb_stick_unlock",type:En.NARRATION,trigger:{type:Tn.ON_NODE_UNLOCKED,nodeId:"usb_stick"},message:"You plug in the USB stick. The computer recognizes it immediately, expanding its available storage. You can now store much more data than before!",duration:bn,persistAcrossAscension:!1,priority:5},{id:"overclock_level2",type:En.NARRATION,trigger:{type:Tn.ON_NODE_LEVEL_REACHED,nodeId:"overclock",level:2},message:"You carefully adjust the system settings to overclock the CPU. The computer hums louder as it works harder, but data generation speeds up noticeably.",duration:bn,persistAcrossAscension:!1,priority:5},{id:"overclock_level5",type:En.NARRATION,trigger:{type:Tn.ON_NODE_LEVEL_REACHED,nodeId:"overclock",level:5},message:"The overclocking is really paying off now! The computer is pushing its limits, and data is flowing in at an impressive rate.",duration:bn,persistAcrossAscension:!1,priority:5},{id:"overclock_level10",type:En.NARRATION,trigger:{type:Tn.ON_NODE_LEVEL_REACHED,nodeId:"overclock",level:10},message:"As you see steam start to rise from the computer, you realize you might have pushed it a bit too far. I guess this is the most this old CPU can handle!",duration:bn,persistAcrossAscension:!1,priority:5}],Ln=[{id:"hint_tier_2_available",type:En.HINT,trigger:{type:Tn.ON_TIER_REACHED,tier:2},message:"Tier 2 nodes unlocked. Costs scale up, but rewards do too.",duration:6e3,persistAcrossAscension:!1,priority:4},{id:"hint_computer_branch",type:En.HINT,trigger:{type:Tn.ON_BRANCH_UNLOCKED,branch:"computer"},message:"The computer branch is now available! Explore grandpa's digital legacy.",duration:7e3,persistAcrossAscension:!1,priority:5},{id:"hint_offline_short",type:En.HINT,trigger:{type:Tn.ON_OFFLINE_RETURN,offlineSeconds:3600},message:"Welcome back! Your automations kept working while you were away.",duration:5e3,persistAcrossAscension:!1,priority:3},{id:"hint_offline_long",type:En.HINT,trigger:{type:Tn.ON_OFFLINE_RETURN,offlineSeconds:28800},message:"You've been gone a while! Check your progressâ€”resources have accumulated.",duration:6e3,persistAcrossAscension:!1,priority:4}];const Dn="networkSimShownNotifications",Mn=8e3,xn=5;function Bn(e,t,n){switch(t){case Sn.GREATER_EQUAL:case">=":return e>=n;case Sn.LESS_EQUAL:case"<=":return e<=n;case Sn.EQUAL:case"==":return e===n;case Sn.GREATER:case">":return e>n;case Sn.LESS:case"<":return e<n;default:return e>=n}}function qn(e){let t=new Set,n=null,s=[],o=[],a=!1,r=null,i=0;const c=new Set,l={energy:new Set,data:new Set,bandwidth:new Set};let d=Date.now(),u=new Set;function p(){r||(r=setTimeout(()=>{try{localStorage.setItem(Dn,JSON.stringify([...t]))}catch(e){"QuotaExceededError"===e.name?console.warn("Storage quota exceeded - shown notifications not saved"):console.error("Failed to save shown notifications:",e)}r=null},1e3))}function g(e){return t.has(e)}function h(e=!1){if(e)for(const n of s)n.persistAcrossAscension||t.delete(n.id);else t.clear();for(const t of["energy","data","bandwidth"])l[t].clear();c.clear(),u.clear(),p()}function f(e){g(e.id)||Nn.has(e.type||En.NARRATION)||(o.push(e),o.sort((e,t)=>(t.priority||xn)-(e.priority||xn)),m())}function m(){if(a||0===o.length)return;a=!0;const n=o.shift();var s;s=n.id,t.add(s),p();const r=n.delay||0;setTimeout(()=>{e.emit("notificationShown",{notification:{id:n.id,message:n.message,type:n.type||En.NARRATION,duration:n.duration||Mn}})},r),setTimeout(()=>{a=!1,m()},r+500)}function y({node:e,level:t}){if(!n)return;if(!(t>1)){const t=n[Tn.ON_NODE_UNLOCKED].get(e.id);if(t)for(const e of t)f(e);const s=String(e.tier);if(!c.has(s)){c.add(s);const e=n[Tn.ON_TIER_REACHED].get(s);if(e)for(const t of e)f(t)}}const s=`${e.id}:${t}`,o=n[Tn.ON_NODE_LEVEL_REACHED].get(s);if(o)for(const n of o)f(n)}function v({branch:e}){if(!n)return;const t=n[Tn.ON_BRANCH_UNLOCKED].get(e);if(t)for(const n of t)f(n)}function _({feature:e}){if(!n)return;const t=n[Tn.ON_FEATURE_UNLOCKED].get(e);if(t)for(const n of t)f(n)}function k({saveExists:e}={}){if(n&&!e){const e=n[Tn.ON_FIRST_LAUNCH];for(const t of e)f(t)}}function E({ascensionCount:e}={}){if(!n)return;h(!0);const t=n[Tn.ON_ASCENSION];for(const n of t)void 0!==n.trigger.count&&n.trigger.count!==e||f(n)}function N(){if(!n)return;const e=(Date.now()-d)/1e3,t=n[Tn.ON_IDLE_TIME];for(const n of t)u.has(n.id)||e>=(n.trigger.idleSeconds||0)&&(u.add(n.id),f(n))}function A(e){const t=Date.now();t-i<500||(i=t,N())}return{initialize:function(){!function(){try{const e=localStorage.getItem(Dn);if(e){const n=JSON.parse(e);t=new Set(Array.isArray(n)?n:[])}}catch(e){console.error("Failed to load shown notifications:",e),t=new Set}}(),s=[...wn,...In,...Un,...Ln],n=function(e){const t={[Tn.ON_NODE_UNLOCKED]:new Map,[Tn.ON_NODE_LEVEL_REACHED]:new Map,[Tn.ON_BRANCH_UNLOCKED]:new Map,[Tn.ON_FEATURE_UNLOCKED]:new Map,[Tn.ON_TIER_REACHED]:new Map,[Tn.ON_FIRST_LAUNCH]:[],[Tn.ON_ASCENSION]:[],[Tn.ON_OFFLINE_RETURN]:[],[Tn.ON_RESOURCE_AMOUNT_REACHED]:{energy:[],data:[],bandwidth:[]},[Tn.ON_IDLE_TIME]:[]};for(const n of e){const{trigger:e}=n;if(null==e?void 0:e.type)switch(e.type){case Tn.ON_NODE_UNLOCKED:{const s=e.nodeId;t[e.type].has(s)||t[e.type].set(s,[]),t[e.type].get(s).push(n);break}case Tn.ON_NODE_LEVEL_REACHED:{const s=`${e.nodeId}:${e.level}`;t[e.type].has(s)||t[e.type].set(s,[]),t[e.type].get(s).push(n);break}case Tn.ON_BRANCH_UNLOCKED:case Tn.ON_FEATURE_UNLOCKED:{const s=e.branch||e.feature;t[e.type].has(s)||t[e.type].set(s,[]),t[e.type].get(s).push(n);break}case Tn.ON_TIER_REACHED:{const s=String(e.tier);t[e.type].has(s)||t[e.type].set(s,[]),t[e.type].get(s).push(n);break}case Tn.ON_RESOURCE_AMOUNT_REACHED:{const s=e.resource||"energy";t[e.type][s]&&t[e.type][s].push(n);break}case Tn.ON_FIRST_LAUNCH:case Tn.ON_ASCENSION:case Tn.ON_OFFLINE_RETURN:case Tn.ON_IDLE_TIME:t[e.type].push(n)}}for(const n of["energy","data","bandwidth"])t[Tn.ON_RESOURCE_AMOUNT_REACHED][n].sort((e,t)=>(e.trigger.threshold||0)-(t.trigger.threshold||0));return t[Tn.ON_IDLE_TIME].sort((e,t)=>(e.trigger.idleSeconds||0)-(t.trigger.idleSeconds||0)),t}(s),e.on("nodeUnlocked",y),e.on("branchUnlocked",v),e.on("featureUnlocked",_),e.on("gameLoaded",k),e.on("ascension",E),e.on("gameTick",A),"undefined"!=typeof window&&(window.__resetNarrations=(e=!1)=>{h(!e),console.log("Narrations reset. Refresh to see first launch again.")})},wasShown:g,queueNotification:f,checkResourceThresholds:function(e){if(n)for(const t of["energy","data","bandwidth"]){const s=e[t]||0,o=n[Tn.ON_RESOURCE_AMOUNT_REACHED][t];if(o&&0!==o.length)for(const e of o){if(l[t].has(e.id))continue;const{threshold:n,comparison:o}=e.trigger;if((">="===o||!o)&&s<n)break;Bn(s,o||">=",n)&&(l[t].add(e.id),f(e))}}},checkIdleThresholds:N,recordInteraction:function(){d=Date.now(),u.clear()},resetShownNotifications:h}}const Pn={id:"game-container"},Gn={id:"header"},Hn={key:0,class:"prestige-header"},Fn={class:"prestige-value"},Kn={class:"prestige-ascension"},jn={id:"resources"},$n={id:"main-content"},Qn=n({__name:"App",setup(e){const t=function(){const e=new Map;function t(t,n){return e.has(t)||e.set(t,[]),e.get(t).push(n),()=>{const s=e.get(t);if(s){const e=s.indexOf(n);e>-1&&s.splice(e,1)}}}return{on:t,emit:function(t,n){e.has(t)&&e.get(t).forEach(e=>{try{e(n)}catch(s){console.error(`Error in event handler for '${t}':`,s)}})},once:function(e,n){const s=t(e,e=>{n(e),s()});return s},off:function(t){t?e.delete(t):e.clear()}}}(),n=function(){const e=C({energy:0,data:0}),t=C({energy:0,data:0}),n=C({energy:0,data:0}),o=l(new Set(["old_shed"])),a=C({}),r=l(new Set(["energy"])),i=l(new Set),c=l(null),d=l(null),u=C({active:!1,progress:0,interval:2e4,bitsPerTick:1,energyCost:1,baseCapacity:1028,capacityBonus:0}),p=C({active:!1,progress:0,interval:1e3,energyPerTick:1}),g=l(!1),h=l(!1),f=s(()=>u.baseCapacity+u.capacityBonus),m=s(()=>i.value.has("dataProcessing")),y=s(()=>m.value&&e.energy>=5),v=s(()=>{let e=0;return o.value.forEach(t=>{const n=Ce.nodes[t];n&&n.tier>e&&(e=n.tier)}),e}),_=s(()=>({nodesUnlocked:o.value.size,totalEnergy:t.energy,totalData:t.data}));return{resources:e,totalResources:t,automations:n,unlockedNodes:o,nodeLevels:a,unlockedBranches:r,unlockedFeatures:i,selectedNodeId:c,lastUnlockedNodeId:d,dataGeneration:u,energyGeneration:p,isCrankBroken:g,isCrankAutomated:h,isDataUnlocked:m,canProcessData:y,highestTierReached:v,maxDataCapacity:f,stats:_,selectNode:function(e){c.value=e},resetResources:function(){Object.keys(e).forEach(t=>e[t]=0),Object.keys(t).forEach(e=>t[e]=0),Object.keys(n).forEach(e=>n[e]=0)},resetNodes:function(){o.value=new Set(["old_shed"]),Object.keys(a).forEach(e=>delete a[e]),r.value=new Set(["energy"]),i.value=new Set,u.active=!1,u.progress=0,u.interval=2e4,u.bitsPerTick=1,u.energyCost=1,u.baseCapacity=100,u.capacityBonus=0,p.active=!1,p.progress=0,p.interval=1e3,p.energyPerTick=1,g.value=!1,h.value=!1},unlockBranch:function(e){if(!r.value.has(e)){const t=new Set(r.value);t.add(e),r.value=t}},unlockFeature:function(e){if(!i.value.has(e)){const t=new Set(i.value);t.add(e),i.value=t}},setLastUnlockedNode:function(e){d.value=e,setTimeout(()=>{d.value===e&&(d.value=null)},1200)}}}(),d=function(){const e=C({ascensionCount:0,quantumCores:0,totalCoresEarned:0,upgrades:new Set,statistics:{fastestClear:null,totalNodesEverUnlocked:0,totalEnergyEverEarned:0,runStartTime:Date.now()}}),t=l(!1),n=s(()=>o());function o(){const t={startingEnergy:0,startingAutomation:{energy:0,data:0,bandwidth:0},startingNodes:new Set(["old_shed"]),costMultiplier:1,automationMultiplier:1,bonusEnergyPerClick:0,coreMultiplier:1,tierCostMultipliers:{},clickPower:1,automation:1,costReduction:0,dataCapacity:1,specialEffects:{}};for(const n of e.upgrades){const e=St[n];if(!e)continue;const s=e.effect;s.startingEnergy&&(t.startingEnergy+=s.startingEnergy),s.costMultiplier&&(t.costMultiplier*=s.costMultiplier),s.automationMultiplier&&(t.automationMultiplier*=s.automationMultiplier),s.bonusEnergyPerClick&&(t.bonusEnergyPerClick+=s.bonusEnergyPerClick),s.coreMultiplier&&(t.coreMultiplier*=s.coreMultiplier),s.startingNodes&&s.startingNodes.forEach(e=>t.startingNodes.add(e)),s.startingAutomation&&Object.entries(s.startingAutomation).forEach(([e,n])=>{t.startingAutomation[e]+=n}),s.tierCostMultipliers&&Object.entries(s.tierCostMultipliers).forEach(([e,n])=>{const s=parseInt(e);t.tierCostMultipliers[s]=(t.tierCostMultipliers[s]||1)*n}),s.startAllTier&&Object.values(Ce.nodes).forEach(e=>{e.tier===s.startAllTier&&t.startingNodes.add(e.id)}),s.randomStartingNodes&&(t.randomStartingNodes=s.randomStartingNodes)}return t}return{prestigeState:e,showAscensionPanel:t,prestigeBonuses:n,calculateQuantumCores:function(e,t){const s=Math.max(0,Math.log10(e.energy+1)),o=t.size/10;let a=0;for(const n of t){const e=Ce.nodes[n];e&&e.tier>=6&&(a+=5*(e.tier-5)),e&&"universe_simulation"===e.id&&(a+=20)}const r=n.value.coreMultiplier;return Math.floor((s+o+a)*r)},getAccumulatedBonuses:o,purchaseUpgrade:function(t){const n=St[t];if(!n)return!1;if(e.upgrades.has(t))return!1;if(!n.requires.every(t=>e.upgrades.has(t)))return!1;if(e.quantumCores<n.cost)return!1;e.quantumCores-=n.cost;const s=new Set(e.upgrades);return s.add(t),e.upgrades=s,!0},toggleAscensionPanel:function(){t.value=!t.value},resetRunTimer:function(){e.statistics.runStartTime=Date.now()}}}(),u=kn(n,d,t,Ce.nodes),p=Rn(n,d,t);qn(t).initialize();const g=s(()=>{const e=d.calculateQuantumCores(n.totalResources,n.unlockedNodes.value);return isNaN(e)?0:e}),y=l(!1),v=()=>{y.value=!y.value};function _(e){if("Escape"===e.key){if(y.value)return void(y.value=!1);if(d.showAscensionPanel.value)return void d.toggleAscensionPanel()}if("u"===e.key||"U"===e.key){const e=n.selectedNodeId.value;e&&p.handleUnlockNode(e)}}return m(()=>{window.addEventListener("keydown",_)}),O(()=>{window.removeEventListener("keydown",_)}),(e,t)=>(r(),o("div",Pn,[i("header",Gn,[i("div",{class:"header-left"},[t[3]||(t[3]=i("h1",null,"Network Simulator",-1)),i("button",{class:"icon-button",onClick:v,title:"View Changelog"},"ðŸ“œ")]),f(d).prestigeState.ascensionCount>0||f(d).prestigeState.quantumCores>0?(r(),o("div",Hn,[i("button",{class:"prestige-button",onClick:t[0]||(t[0]=(...e)=>f(d).toggleAscensionPanel&&f(d).toggleAscensionPanel(...e)),title:"View Ascension Upgrades"},[t[4]||(t[4]=i("span",{class:"prestige-icon"},"ðŸ’Ž",-1)),i("span",Fn,c(f(d).prestigeState.quantumCores),1),t[5]||(t[5]=i("span",{class:"prestige-label"},"Quantum Cores",-1)),i("span",Kn,"Ascension "+c(f(d).prestigeState.ascensionCount),1)])])):a("",!0),i("div",jn,[h(x,{icon:"âš¡",name:"W",amount:f(n).resources.energy,rate:f(u).resourceRates.value.energy},null,8,["amount","rate"]),h(x,{icon:"ðŸ“Š",name:"B",amount:f(n).resources.data,rate:f(u).resourceRates.value.data,visible:f(n).isDataUnlocked.value},null,8,["amount","rate","visible"])])]),i("main",$n,[h(de,{"resource-stats":{energyPerClick:f(u).computedValues.value.energyPerClick,dataPerClick:f(u).dataPerClickDisplay.value,stats:f(n).stats.value},"generation-state":{dataGeneration:f(n).dataGeneration,energyGeneration:f(n).energyGeneration,isCrankBroken:f(n).isCrankBroken.value,isCrankAutomated:f(n).isCrankAutomated.value},"game-stats":{automations:f(n).automations,effectiveRates:{energy:f(u).resourceRates.value.energy,data:f(u).resourceRates.value.data},coresEarned:g.value,highestTierReached:f(n).highestTierReached.value,isDataUnlocked:f(n).isDataUnlocked.value,canProcessData:f(n).canProcessData.value},onGenerateEnergy:f(u).generateEnergy,onProcessData:f(u).processData,onAscend:f(p).ascend},null,8,["resource-stats","generation-state","game-stats","onGenerateEnergy","onProcessData","onAscend"]),h($e,{nodes:f(Ce).nodes,"unlocked-nodes":f(n).unlockedNodes.value,"unlocked-branches":f(n).unlockedBranches.value,"selected-node-id":f(n).selectedNodeId.value,resources:f(n).resources,"ascension-count":f(d).prestigeState.ascensionCount,"prestige-bonuses":f(d).prestigeBonuses.value,"last-unlocked-node-id":f(n).lastUnlockedNodeId.value,"node-levels":f(n).nodeLevels,onSelectNode:f(n).selectNode},null,8,["nodes","unlocked-nodes","unlocked-branches","selected-node-id","resources","ascension-count","prestige-bonuses","last-unlocked-node-id","node-levels","onSelectNode"]),h(gt,{node:f(u).selectedNode.value,"is-unlocked":f(u).isSelectedNodeUnlocked.value,"is-available":f(u).isSelectedNodeAvailable.value,"is-tier-locked":f(u).isTierLocked.value,"tier-gate":f(u).tierGateRequirement.value,"can-afford":f(u).canAffordSelectedNode.value,resources:f(n).resources,"unlocked-nodes":f(n).unlockedNodes.value,"ascension-count":f(d).prestigeState.ascensionCount,"prestige-bonuses":f(d).prestigeBonuses.value,"node-level":f(u).selectedNode.value?f(u).getNodeLevel(f(u).selectedNode.value.id):0,"can-upgrade":!!f(u).selectedNode.value&&f(u).canUpgradeNode(f(u).selectedNode.value),"node-levels":f(n).nodeLevels,onUnlock:f(p).handleUnlockNode},null,8,["node","is-unlocked","is-available","is-tier-locked","tier-gate","can-afford","resources","unlocked-nodes","ascension-count","prestige-bonuses","node-level","can-upgrade","node-levels","onUnlock"])]),h(ft,{notifications:f(p).notifications.value},null,8,["notifications"]),i("button",{id:"notification-history-button",onClick:t[1]||(t[1]=(...e)=>f(p).toggleNotificationHistory&&f(p).toggleNotificationHistory(...e)),title:"Notification History"},"ðŸ””"),h(Tt,{show:f(p).showNotificationHistory.value,history:f(p).notificationHistory.value,"narrate-only-filter":f(p).narrateOnlyFilter.value,onClose:f(p).toggleNotificationHistory,"onUpdate:narrateOnlyFilter":t[2]||(t[2]=e=>f(p).narrateOnlyFilter.value=e)},null,8,["show","history","narrate-only-filter","onClose"]),h(dn,{visible:f(d).showAscensionPanel.value,"quantum-cores":f(d).prestigeState.quantumCores,"ascension-count":f(d).prestigeState.ascensionCount,"purchased-upgrades":f(d).prestigeState.upgrades,statistics:f(d).prestigeState.statistics,"total-cores-earned":f(d).prestigeState.totalCoresEarned,onPurchaseUpgrade:f(p).handlePurchaseUpgrade,onClose:f(d).toggleAscensionPanel},null,8,["visible","quantum-cores","ascension-count","purchased-upgrades","statistics","total-cores-earned","onPurchaseUpgrade","onClose"]),h(_n,{visible:y.value,onClose:v},null,8,["visible"])]))}});function Yn(e){return"string"==typeof e?e:e.id}class zn{buildTree(e){const t={nodesByTier:{},children:{},parents:{},maxTier:0,descendants:{}};return Object.values(e).forEach(e=>{t.nodesByTier[e.tier]||(t.nodesByTier[e.tier]=[]),t.nodesByTier[e.tier].push(e.id),t.maxTier=Math.max(t.maxTier,e.tier),t.parents[e.id]=(e.requires||[]).map(Yn),t.children[e.id]=[]}),Object.values(e).forEach(e=>{e.requires.forEach(n=>{const s=Yn(n);t.children[s]&&t.children[s].push(e.id)})}),Object.keys(e).forEach(n=>{t.descendants[n]=this.countDescendants(n,t,e)}),t}countDescendants(e,t,n,s=new Set){if(s.has(e))return 0;s.add(e);const o=t.children[e]||[];let a=o.length;return o.forEach(e=>{a+=this.countDescendants(e,t,n,s)}),a}assignBranches(e,t){e.old_shed&&(e.old_shed.branch="old_shed",e.old_shed.branchAngle=0);const n=t.nodesByTier[1]||[],s=n.length;n.forEach((t,n)=>{const o=-Math.PI/2+2*Math.PI*n/s;e[t].branch=t,e[t].branchAngle=o});for(let o=2;o<=t.maxTier;o++){(t.nodesByTier[o]||[]).forEach(t=>{const n=e[t],s=n.requires.map(t=>e[Yn(t)]).filter(e=>e);if(0===s.length)return;const o=s.map(e=>e.branchAngle).filter(e=>void 0!==e);o.length>0&&(n.branchAngle=this.averageAngle(o),n.branch=s[0].branch)})}}averageAngle(e){if(0===e.length)return 0;if(1===e.length)return e[0];let t=0,n=0;return e.forEach(e=>{t+=Math.sin(e),n+=Math.cos(e)}),Math.atan2(t/e.length,n/e.length)}}function Wn(e){return"string"==typeof e?e:e.id}class Vn{constructor(e){this.config=e}calculateDepth(e,t,n={}){if(void 0!==n[e])return n[e];const s=t[e];if(!s)return{depth:0,sameTierHops:0};if(0===s.tier)return n[e]={depth:0,sameTierHops:0},n[e];if(1===s.tier)return n[e]={depth:1,sameTierHops:0},n[e];const o=(s.requires||[]).map(e=>t[Wn(e)]).filter(e=>e);if(0===o.length)return n[e]={depth:s.tier,sameTierHops:0},n[e];const a=o.map(e=>this.calculateDepth(e.id,t,n)),r=Math.max(...a.map(e=>e.depth)),i=o.find((e,t)=>a[t].depth===r),c=a[o.indexOf(i)],l=i&&i.tier===s.tier;return n[e]={depth:r+1,sameTierHops:c.sameTierHops+(l?1:0)},n[e]}calculateRadius(e){const{tierSpacing:t,sameTierOffset:n}=this.config;return(e.depth-e.sameTierHops)*t+e.sameTierHops*n}averageAngle(e){if(0===e.length)return 0;if(1===e.length)return e[0];let t=0,n=0;return e.forEach(e=>{t+=Math.sin(e),n+=Math.cos(e)}),Math.atan2(t/e.length,n/e.length)}calculatePositions(e){const{centerX:t,centerY:n,tierSpacing:s}=this.config;e.old_shed&&(e.old_shed.x=t,e.old_shed.y=n);const o={};Object.keys(e).forEach(t=>{const n=this.calculateDepth(t,e,o);e[t].depthInfo=n,e[t].depth=n.depth});const a=Math.max(...Object.values(e).map(e=>e.depth||0)),r=Object.values(e).filter(e=>1===e.depth),i=s;r.forEach(e=>{e.x=t+Math.cos(e.branchAngle)*i,e.y=n+Math.sin(e.branchAngle)*i});for(let l=2;l<=a;l++){const s=Object.values(e).filter(e=>e.depth===l).map(e=>e.id);if(0===s.length)continue;const o=s.filter(t=>1===(e[t].requires||[]).length);s.filter(t=>(e[t].requires||[]).length>1).forEach(s=>{const o=e[s],a=this.calculateRadius(o.depthInfo);o.x=t+Math.cos(o.branchAngle)*a,o.y=n+Math.sin(o.branchAngle)*a});this.groupByParent(o,e).forEach(s=>{const o=e[s.parentId],a=o&&o.branchAngle||0,r=s.nodes,i=r.length,c=.25/Math.sqrt(l);r.sort((e,t)=>e.localeCompare(t)),r.forEach((s,o)=>{const r=e[s],l=this.calculateRadius(r.depthInfo);let d=a;if(i>1){d=a+(o-(i-1)/2)*c}r.branchAngle=d,r.x=t+Math.cos(d)*l,r.y=n+Math.sin(d)*l})})}const c=this.config.nodeSize/2;Object.values(e).forEach(e=>{e.x=Math.round(e.x-c),e.y=Math.round(e.y-c)})}groupByParent(e,t){const n={};return e.forEach(e=>{const s=t[e],o=s.requires&&s.requires.length>0?Wn(s.requires[0]):"old_shed";n[o]||(n[o]={parentId:o,nodes:[]}),n[o].nodes.push(e)}),Object.values(n)}}class Jn{constructor(e){this.config=e}resolveCollisions(e){const t=Object.values(e),n=this.config.nodeSpacing,s=2*n;for(let o=0;o<15;o++){let e=0;const o=this.buildSpatialGrid(t,s);if(t.forEach(t=>{const a=this.getGridCellKey(t.x,t.y,s),[r,i]=a.split(",").map(Number);for(let s=-1;s<=1;s++)for(let a=-1;a<=1;a++){const c=`${r+s},${i+a}`;(o.get(c)||[]).forEach(s=>{if(t.id>=s.id)return;const o=s.x-t.x,a=s.y-t.y,r=Math.sqrt(o*o+a*a);if(r<n&&r>0){const i=n-r;e=Math.max(e,i);const c=o/r*i*.5,l=a/r*i*.5;"old_shed"!==t.id&&(t.x-=c,t.y-=l),"old_shed"!==s.id&&(s.x+=c,s.y+=l)}})}}),e<1)break}t.forEach(e=>{e.x=Math.round(e.x),e.y=Math.round(e.y)})}buildSpatialGrid(e,t){const n=new Map;return e.forEach(e=>{const s=this.getGridCellKey(e.x,e.y,t);n.has(s)||n.set(s,[]),n.get(s).push(e)}),n}getGridCellKey(e,t,n){return`${Math.floor(e/n)},${Math.floor(t/n)}`}}(new class{constructor(){t(this,"config"),t(this,"treeBuilder"),t(this,"positionCalculator"),t(this,"collisionResolver"),this.config={centerX:_e.CENTER_X,centerY:_e.CENTER_Y,tierSpacing:_e.TIER_SPACING,sameTierOffset:_e.SAME_TIER_OFFSET,nodeSpacing:_e.NODE_SPACING,nodeSize:_e.NODE_SIZE},this.treeBuilder=new zn,this.positionCalculator=new Vn(this.config),this.collisionResolver=new Jn(this.config)}calculateLayout(e){const t=structuredClone(e),n=this.treeBuilder.buildTree(t);return this.treeBuilder.assignBranches(t,n),this.positionCalculator.calculatePositions(t),this.collisionResolver.resolveCollisions(t),t}applyLayout(e){const t=this.calculateLayout(e.nodes);return Object.keys(t).forEach(n=>{e.nodes[n]&&(e.nodes[n].x=t[n].x,e.nodes[n].y=t[n].y)}),e}initializeLayout(e){e&&e.nodes&&this.applyLayout(e)}}).initializeLayout(Ce);R(Qn).mount("#app");
//# sourceMappingURL=main-ClrHGxBn.js.map
